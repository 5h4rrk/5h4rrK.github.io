<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Windows Bigpools | shark.exe</title>
<meta name="keywords" content="Windows BigPool, Windows memory allocation, paged pool, non-paged pool, kernel large allocations, MmBigPoolInformation, Poolmon, Windows Kernel memory">
<meta name="description" content="An overview of how the Windows Kernel handles large memory allocations using BigPools, including internal structures and debugging techniques.">
<meta name="author" content="5h4rrk">
<link rel="canonical" href="http://localhost:1313/posts/windows-bigpools/windows-bigpools/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.269e8b8ce223fd58e69f6c25272b6080bbd2f724085a64f304d5c4c6c5e90969.css" integrity="sha256-Jp6LjOIj/Vjmn2wlJytggLvS9yQIWmTzBNXExsXpCWk=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/windows-bigpools/windows-bigpools/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="http://localhost:1313/posts/windows-bigpools/windows-bigpools/">
  <meta property="og:site_name" content="shark.exe">
  <meta property="og:title" content="Windows Bigpools">
  <meta property="og:description" content="An overview of how the Windows Kernel handles large memory allocations using BigPools, including internal structures and debugging techniques.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-30T08:02:59+05:30">
    <meta property="article:modified_time" content="2025-05-30T08:02:59+05:30">
    <meta property="article:tag" content="Windows Internals">
    <meta property="article:tag" content="Memory Management">
    <meta property="article:tag" content="Kernel Debugging">
    <meta property="article:tag" content="BigPool">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Windows Bigpools">
<meta name="twitter:description" content="An overview of how the Windows Kernel handles large memory allocations using BigPools, including internal structures and debugging techniques.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Windows Bigpools",
      "item": "http://localhost:1313/posts/windows-bigpools/windows-bigpools/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Windows Bigpools",
  "name": "Windows Bigpools",
  "description": "An overview of how the Windows Kernel handles large memory allocations using BigPools, including internal structures and debugging techniques.",
  "keywords": [
    "Windows BigPool", "Windows memory allocation", "paged pool", "non-paged pool", "kernel large allocations", "MmBigPoolInformation", "Poolmon", "Windows Kernel memory"
  ],
  "articleBody": "PoolTag is a 4 bytes value (unsigned int value) present in the header (i.e. POOL_HEADER) .Microsoft creates pool tag mostly for debugging purposes. So, whenever Kernel creates any object in pool memory, it creates a POOL_HEADER which contains a PoolTag field which contains information regarding what kind of object is being created.\n0: kd\u003e dt nt!_POOL_HEADER +0x000 PreviousSize : Pos 0, 8 Bits +0x000 PoolIndex : Pos 8, 8 Bits +0x002 BlockSize : Pos 0, 8 Bits +0x002 PoolType : Pos 8, 8 Bits +0x000 Ulong1 : Uint4B +0x004 PoolTag : Uint4B +0x008 ProcessBilled : Ptr64 _EPROCESS +0x008 AllocatorBackTraceIndex : Uint2B +0x00a PoolTagHash : Uint2B Let’s look at one of the running process, how it actually looks like\n0: kd\u003e !process 0 0 cmd.exe PROCESS ffffc509bf28b080 SessionId: 1 Cid: 1164 Peb: 72ce659000 ParentCid: 1148 DirBase: 5e2bc002 ObjectTable: ffff99011473e500 HandleCount: 245. Image: cmd.exe 0: kd\u003e dt nt!_POOL_HEADER ffffc509bf28b000 +0x000 PreviousSize : 0y00000000 (0) +0x000 PoolIndex : 0y00000000 (0) +0x002 BlockSize : 0y11010000 (0xd0) +0x002 PoolType : 0y00000010 (0x2) +0x000 Ulong1 : 0x2d00000 +0x004 PoolTag : 0x636f7250 +0x008 ProcessBilled : (null) +0x008 AllocatorBackTraceIndex : 0 +0x00a PoolTagHash : 0 0x636f7250: It’s a little endian value. On changing it to ascii, corP -\u003e Proc which represents an process object.\nFor more information on different windows pool tags, please look at pooltag.txt\nWindows Kernel groups similar size memory allocations together. If the requested size exceeds one page (0x1000) bytes, the memory would be allocated from special pool i.e. big pool which is for large allocations.\n0: kd\u003e dt nt!_POOL_TRACKER_BIG_PAGES +0x000 Va : Uint8B +0x008 Key : Uint4B +0x00c Pattern : Pos 0, 8 Bits +0x00c PoolType : Pos 8, 12 Bits +0x00c SlushSize : Pos 20, 12 Bits +0x010 NumberOfBytes : Uint8B 0: kd\u003e ?? sizeof(nt!_POOL_TRACKER_BIG_PAGES) unsigned int64 0x18 0: kd\u003e x nt!PoolBigPageTable fffff805`4ee16a68 nt!PoolBigPageTable = ",
  "wordCount" : "1247",
  "inLanguage": "en",
  "datePublished": "2025-05-30T08:02:59+05:30",
  "dateModified": "2025-05-30T08:02:59+05:30",
  "author":{
    "@type": "Person",
    "name": "5h4rrk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/windows-bigpools/windows-bigpools/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "shark.exe",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="shark.exe (Alt + H)">shark.exe</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Windows Bigpools
    </h1>
    <div class="post-description">
      An overview of how the Windows Kernel handles large memory allocations using BigPools, including internal structures and debugging techniques.
    </div>
    <div class="post-meta"><span title='2025-05-30 08:02:59 +0530 IST'>May 30, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;5h4rrk

</div>
  </header> 

  <div class="post-content"><p>PoolTag is a 4 bytes value (unsigned int value) present in the header (i.e. <code>POOL_HEADER</code>) .Microsoft creates pool tag mostly for debugging purposes. So, whenever Kernel creates any object in pool memory, it creates a <code>POOL_HEADER</code> which contains a <code>PoolTag</code> field which contains information regarding what kind of object is being created.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dt nt!_POOL_HEADER 
</span></span><span class="line"><span class="cl">   +0x000 PreviousSize     : Pos 0, <span class="m">8</span> Bits
</span></span><span class="line"><span class="cl">   +0x000 PoolIndex        : Pos 8, <span class="m">8</span> Bits
</span></span><span class="line"><span class="cl">   +0x002 BlockSize        : Pos 0, <span class="m">8</span> Bits
</span></span><span class="line"><span class="cl">   +0x002 PoolType         : Pos 8, <span class="m">8</span> Bits
</span></span><span class="line"><span class="cl">   +0x000 Ulong1           : Uint4B
</span></span><span class="line"><span class="cl">   +0x004 PoolTag          : Uint4B
</span></span><span class="line"><span class="cl">   +0x008 ProcessBilled    : Ptr64 _EPROCESS
</span></span><span class="line"><span class="cl">   +0x008 AllocatorBackTraceIndex : Uint2B
</span></span><span class="line"><span class="cl">   +0x00a PoolTagHash      : Uint2B
</span></span></code></pre></div><p>Let&rsquo;s look at one of the running process, how it actually looks like</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; !process <span class="m">0</span> <span class="m">0</span> cmd.exe
</span></span><span class="line"><span class="cl">PROCESS ffffc509bf28b080
</span></span><span class="line"><span class="cl">    SessionId: <span class="m">1</span>  Cid: <span class="m">1164</span>    Peb: 72ce659000  ParentCid: <span class="m">1148</span>
</span></span><span class="line"><span class="cl">    DirBase: 5e2bc002  ObjectTable: ffff99011473e500  HandleCount: 245.
</span></span><span class="line"><span class="cl">    Image: cmd.exe
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; dt nt!_POOL_HEADER ffffc509bf28b000
</span></span><span class="line"><span class="cl">   +0x000 PreviousSize     : 0y00000000 <span class="o">(</span>0<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 PoolIndex        : 0y00000000 <span class="o">(</span>0<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x002 BlockSize        : 0y11010000 <span class="o">(</span>0xd0<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x002 PoolType         : 0y00000010 <span class="o">(</span>0x2<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Ulong1           : 0x2d00000
</span></span><span class="line"><span class="cl">   +0x004 PoolTag          : 0x636f7250
</span></span><span class="line"><span class="cl">   +0x008 ProcessBilled    : <span class="o">(</span>null<span class="o">)</span> 
</span></span><span class="line"><span class="cl">   +0x008 AllocatorBackTraceIndex : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x00a PoolTagHash      : <span class="m">0</span>
</span></span></code></pre></div><p><code>0x636f7250</code>: It&rsquo;s a little endian value. On changing it to ascii, <code>corP</code> -&gt; <code>Proc</code> which represents an process object.</p>
<p>For more information  on different windows pool tags, please look at <a href="https://raw.githubusercontent.com/jjzhang166/windbgtool/refs/heads/master/Dependecies/x64/triage/pooltag.txt">pooltag.txt</a></p>
<p>Windows Kernel groups similar size memory allocations together. If the requested size exceeds one page (0x1000)  bytes, the memory would be allocated from special pool i.e. big pool which is for large allocations.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dt nt!_POOL_TRACKER_BIG_PAGES
</span></span><span class="line"><span class="cl">   +0x000 Va               : Uint8B
</span></span><span class="line"><span class="cl">   +0x008 Key              : Uint4B
</span></span><span class="line"><span class="cl">   +0x00c Pattern          : Pos 0, <span class="m">8</span> Bits
</span></span><span class="line"><span class="cl">   +0x00c PoolType         : Pos 8, <span class="m">12</span> Bits
</span></span><span class="line"><span class="cl">   +0x00c SlushSize        : Pos 20, <span class="m">12</span> Bits
</span></span><span class="line"><span class="cl">   +0x010 NumberOfBytes    : Uint8B
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; ?? sizeof<span class="o">(</span>nt!_POOL_TRACKER_BIG_PAGES<span class="o">)</span>
</span></span><span class="line"><span class="cl">unsigned int64 0x18
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; x nt!PoolBigPageTable
</span></span><span class="line"><span class="cl">fffff805<span class="sb">`</span>4ee16a68 nt!PoolBigPageTable <span class="o">=</span> &lt;no <span class="nb">type</span> information&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; x nt!PoolBigPageTableSize
</span></span><span class="line"><span class="cl">fffff805<span class="sb">`</span>4ee19290 nt!PoolBigPageTableSize <span class="o">=</span> &lt;no <span class="nb">type</span> information&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; db fffff805<span class="sb">`</span>4ee16a68
</span></span><span class="line"><span class="cl">fffff805<span class="sb">`</span>4ee16a68  <span class="m">00</span> f0 e6 <span class="m">93</span> <span class="m">85</span> b5 ff ff-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">fffff805<span class="sb">`</span>4ee16a78  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">20</span> <span class="m">60</span> <span class="m">90</span> <span class="m">85</span> b5 ff ff  ......... <span class="sb">`</span>.....
</span></span><span class="line"><span class="cl">fffff805<span class="sb">`</span>4ee16a88  <span class="m">00</span> <span class="m">80</span> <span class="m">18</span> bb <span class="m">80</span> d8 ff ff-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">fffff805<span class="sb">`</span>4ee16a98  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">BigPoolTableAddress
</span></span><span class="line"><span class="cl">0: kd&gt; dps fffff805<span class="sb">`</span>4ee16a68 L1
</span></span><span class="line"><span class="cl">fffff805<span class="sb">`</span>4ee16a68  ffffb585<span class="sb">`</span>93e6f000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">BigPoolTableSize
</span></span><span class="line"><span class="cl">0: kd&gt; dps fffff805<span class="sb">`</span>4ee19290 L1
</span></span><span class="line"><span class="cl">fffff805<span class="sb">`</span>4ee19290  00000000<span class="sb">`</span><span class="m">00004000</span>
</span></span></code></pre></div><p>Memory Dump</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; db ffffb585<span class="sb">`</span>93e6f000
</span></span><span class="line"><span class="cl">ffffb585<span class="sb">`</span>93e6f000  <span class="m">00</span> <span class="m">80</span> <span class="m">77</span> 5d <span class="m">06</span> c7 ff ff-4d 6d <span class="m">52</span> <span class="m">65</span> <span class="m">00</span> <span class="m">01</span> <span class="m">04</span> <span class="m">00</span>  ..w<span class="o">]</span>....MmRe....
</span></span><span class="line"><span class="cl">ffffb585<span class="sb">`</span>93e6f010  <span class="m">00</span> <span class="m">80</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">70</span> 7f <span class="m">97</span> <span class="m">85</span> b5 ff ff  .........p......
</span></span><span class="line"><span class="cl">ffffb585<span class="sb">`</span>93e6f020  <span class="m">73</span> 6d <span class="m">42</span> <span class="m">74</span> <span class="m">00</span> <span class="m">00</span> <span class="m">02</span> 00-00 <span class="m">10</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  smBt............
</span></span><span class="line"><span class="cl">ffffb585<span class="sb">`</span>93e6f030  <span class="m">01</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">ffffb585<span class="sb">`</span>93e6f040  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-01 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">ffffb585<span class="sb">`</span>93e6f050  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">ffffb585<span class="sb">`</span>93e6f060  <span class="m">00</span> <span class="m">40</span> df <span class="m">58</span> <span class="m">06</span> c7 ff ff-43 4d <span class="m">32</span> <span class="m">35</span> <span class="m">00</span> <span class="m">05</span> <span class="m">00</span> <span class="m">00</span>  .@.X....CM25....
</span></span><span class="line"><span class="cl">ffffb585<span class="sb">`</span>93e6f070  <span class="m">00</span> <span class="m">10</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">40</span> <span class="m">35</span> bc <span class="m">80</span> d8 ff ff  .........@5.....
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dt nt!_POOL_TRACKER_BIG_PAGES ffffb585<span class="sb">`</span>93e6f000
</span></span><span class="line"><span class="cl">   +0x000 Va               : 0xffffc706<span class="sb">`</span>5d778000
</span></span><span class="line"><span class="cl">   +0x008 Key              : 0x65526d4d
</span></span><span class="line"><span class="cl">   +0x00c Pattern          : 0y00000000 <span class="o">(</span>0<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x00c PoolType         : 0y010000000001 <span class="o">(</span>0x401<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x00c SlushSize        : 0y000000000000 <span class="o">(</span>0<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x010 NumberOfBytes    : 0x8000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; db 0xffffc706<span class="sb">`</span>5d778000
</span></span><span class="line"><span class="cl">ffffc706<span class="sb">`</span>5d778000  <span class="m">70</span> <span class="m">80</span> <span class="m">77</span> 5d <span class="m">06</span> c7 ff ff-81 <span class="m">50</span> f8 <span class="m">95</span> <span class="m">85</span> b5 ff ff  p.w<span class="o">]</span>.....P......
</span></span><span class="line"><span class="cl">ffffc706<span class="sb">`</span>5d778010  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">ffffc706<span class="sb">`</span>5d778020  <span class="m">78</span> 8f <span class="m">77</span> 5d <span class="m">06</span> c7 ff ff-00 <span class="m">00</span> d5 5b <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  x.w<span class="o">]</span>.......<span class="o">[</span>....
</span></span><span class="line"><span class="cl">ffffc706<span class="sb">`</span>5d778030  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-e1 <span class="m">01</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">ffffc706<span class="sb">`</span>5d778040  4d <span class="m">01</span> <span class="m">00</span> <span class="m">00</span> <span class="m">03</span> <span class="m">00</span> <span class="m">00</span> 00-0b <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  M...............
</span></span><span class="line"><span class="cl">ffffc706<span class="sb">`</span>5d778050  4c <span class="m">01</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 d0 <span class="m">75</span> 5d <span class="m">06</span> c7 ff ff  L.........u<span class="o">]</span>....
</span></span><span class="line"><span class="cl">ffffc706<span class="sb">`</span>5d778060  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">ffffc706<span class="sb">`</span>5d778070  <span class="m">01</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-78 8f <span class="m">77</span> 5d <span class="m">06</span> c7 ff ff  ........x.w<span class="o">]</span>....
</span></span></code></pre></div><p>Let&rsquo;s write an WinDbg extension to parse the structures and display the information.</p>
<p><code>bigPools.js</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="s2">&#34;use strict&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">CreateFileLog</span><span class="p">(</span><span class="nx">f</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">host</span><span class="p">.</span><span class="nx">namespace</span><span class="p">.</span><span class="nx">Debugger</span><span class="p">.</span><span class="nx">Utility</span><span class="p">.</span><span class="nx">FileSystem</span><span class="p">.</span><span class="nx">CreateTextWriter</span><span class="p">(</span><span class="nx">f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Print</span><span class="p">(</span><span class="nx">dlog</span><span class="p">,</span><span class="nx">output_string</span><span class="p">,</span> <span class="nx">args</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nx">dlog</span><span class="p">(</span><span class="nx">output_string</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="s2">&#34;\n&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">PrintPoolEntries</span><span class="p">(</span><span class="nx">dlog</span><span class="p">,</span><span class="nx">baseOffset</span><span class="p">,</span> <span class="nx">offset</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">pattern</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">slushsize</span><span class="p">,</span> <span class="nx">numberOfBytes</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">dlog</span><span class="p">(</span><span class="nx">baseOffset</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="nx">offset</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="nx">pattern</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="nx">slushsize</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="nx">numberOfBytes</span><span class="p">,</span> <span class="s2">&#34;\n&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">PoolType</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPool</span><span class="o">:</span> <span class="mh">0x0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolExecute</span><span class="o">:</span> <span class="mh">0x0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">PagedPool</span><span class="o">:</span> <span class="mh">0x1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolMustSucceed</span><span class="o">:</span> <span class="mh">0x2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">DontUseThisType</span><span class="o">:</span> <span class="mh">0x3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolCacheAligned</span><span class="o">:</span> <span class="mh">0x4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">PagedPoolCacheAligned</span><span class="o">:</span> <span class="mh">0x5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolCacheAlignedMustS</span><span class="o">:</span> <span class="mh">0x6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">MaxPoolType</span><span class="o">:</span> <span class="mh">0x7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolBase</span><span class="o">:</span> <span class="mh">0x0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolBaseMustSucceed</span><span class="o">:</span> <span class="mh">0x2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolBaseCacheAligned</span><span class="o">:</span> <span class="mh">0x4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolBaseCacheAlignedMustS</span><span class="o">:</span> <span class="mh">0x6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolSession</span><span class="o">:</span> <span class="mh">0x20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">PagedPoolSession</span><span class="o">:</span> <span class="mh">0x21</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolMustSucceedSession</span><span class="o">:</span> <span class="mh">0x22</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">DontUseThisTypeSession</span><span class="o">:</span> <span class="mh">0x23</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolCacheAlignedSession</span><span class="o">:</span> <span class="mh">0x24</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">PagedPoolCacheAlignedSession</span><span class="o">:</span> <span class="mh">0x25</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolCacheAlignedMustSSession</span><span class="o">:</span> <span class="mh">0x26</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolNx</span><span class="o">:</span> <span class="mh">0x200</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolNxCacheAligned</span><span class="o">:</span> <span class="mh">0x204</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NonPagedPoolSessionNx</span><span class="o">:</span> <span class="mh">0x220</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">DecodeBigPool</span><span class="p">(</span><span class="nx">baseAddress</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">dlog</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">diagnostics</span><span class="p">.</span><span class="nx">debugLog</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">virtual_address</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">host</span><span class="p">.</span><span class="nx">parseInt64</span><span class="p">(</span><span class="nx">host</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">readMemoryValues</span><span class="p">(</span><span class="nx">baseAddress</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">key</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">host</span><span class="p">.</span><span class="nx">parseInt64</span><span class="p">(</span><span class="nx">host</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">readMemoryValues</span><span class="p">(</span><span class="nx">baseAddress</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)[</span><span class="mi">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">key</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kd">let</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">host</span><span class="p">.</span><span class="nx">parseInt64</span><span class="p">(</span><span class="nx">host</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">readMemoryValues</span><span class="p">(</span><span class="nx">baseAddress</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)[</span><span class="mi">3</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="kd">let</span> <span class="nx">pattern</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">;</span> <span class="c1">// Extract 8 bits
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kd">let</span> <span class="nx">type</span> <span class="o">=</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x0f</span><span class="p">;</span> <span class="c1">// Extract bits 8-12
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kd">let</span> <span class="nx">slushsize</span> <span class="o">=</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">;</span> <span class="c1">// Extract bits 12-20
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="kd">let</span> <span class="nx">NumberOfBytes</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">host</span><span class="p">.</span><span class="nx">parseInt64</span><span class="p">(</span><span class="nx">host</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">readMemoryValues</span><span class="p">(</span><span class="nx">baseAddress</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">,</span> <span class="mi">8</span><span class="p">)[</span><span class="mi">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nx">PrintPoolEntries</span><span class="p">(</span><span class="nx">dlog</span><span class="p">,</span> <span class="nx">baseAddress</span> <span class="p">,</span><span class="nx">virtual_address</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">pattern</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">slushsize</span><span class="p">,</span> <span class="nx">NumberOfBytes</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">logfileName</span> <span class="o">=</span> <span class="s2">&#34;E:\\output.log&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">flog</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">file</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">temp</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">offset</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">fileObject</span> <span class="o">=</span> <span class="mi">0</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">CreateIfFileNotExists</span><span class="p">(</span><span class="nx">filePath</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">host</span><span class="p">.</span><span class="nx">namespace</span><span class="p">.</span><span class="nx">Debugger</span><span class="p">.</span><span class="nx">Utility</span><span class="p">.</span><span class="nx">FileSystem</span><span class="p">.</span><span class="nx">FileExists</span><span class="p">(</span><span class="nx">filePath</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="sb">`File Not Found </span><span class="si">${</span><span class="nx">filePath</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">catch</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">fileObject</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">namespace</span><span class="p">.</span><span class="nx">Debugger</span><span class="p">.</span><span class="nx">Utility</span><span class="p">.</span><span class="nx">FileSystem</span><span class="p">.</span><span class="nx">CreateFile</span><span class="p">(</span><span class="nx">filePath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">fileObject</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">namespace</span><span class="p">.</span><span class="nx">Debugger</span><span class="p">.</span><span class="nx">Utility</span><span class="p">.</span><span class="nx">FileSystem</span><span class="p">.</span><span class="nx">OpenFile</span><span class="p">(</span><span class="nx">filePath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">initializeScript</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">dlog</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">diagnostics</span><span class="p">.</span><span class="nx">debugLog</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">dlog</span><span class="p">(</span><span class="s2">&#34;Initialized Script\n&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="k">new</span> <span class="nx">host</span><span class="p">.</span><span class="nx">apiVersionSupport</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="k">new</span> <span class="nx">host</span><span class="p">.</span><span class="nx">functionAlias</span><span class="p">(</span><span class="nx">PrintBigPoolTables</span><span class="p">,</span> <span class="s2">&#34;PringBigPoolTables&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">invokeScript</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">CreateIfFileNotExists</span><span class="p">(</span><span class="nx">logfileName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">PrintBigPoolTables</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">PrintBigPoolTables</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">dlog</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">diagnostics</span><span class="p">.</span><span class="nx">debugLog</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">bigPoolTableAddress</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">getModuleSymbolAddress</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;nt&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;PoolBigPageTable&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">bigPoolTableSizeAddress</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">getModuleSymbolAddress</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;nt&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;PoolBigPageTableSize&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nx">Print</span><span class="p">(</span><span class="nx">dlog</span><span class="p">,</span><span class="s2">&#34;Pool Table Entries Address : &#34;</span><span class="p">,</span> <span class="nx">bigPoolTableAddress</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">bigPoolTable</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">readMemoryValues</span><span class="p">(</span><span class="nx">bigPoolTableAddress</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">bigPoolTableSize</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">readMemoryValues</span><span class="p">(</span><span class="nx">bigPoolTableSizeAddress</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">Print</span><span class="p">(</span><span class="nx">dlog</span><span class="p">,</span> <span class="s2">&#34;Big Pool Table Base Address : &#34;</span><span class="p">,</span><span class="nx">bigPoolTable</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Print</span><span class="p">(</span><span class="nx">dlog</span><span class="p">,</span> <span class="s2">&#34;Big Pool Table Base Size : &#34;</span><span class="p">,</span><span class="nx">bigPoolTableSize</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">ctl</span> <span class="o">=</span> <span class="nx">host</span><span class="p">.</span><span class="nx">namespace</span><span class="p">.</span><span class="nx">Debugger</span><span class="p">.</span><span class="nx">Utility</span><span class="p">.</span><span class="nx">Control</span><span class="p">;</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">PoolTrackerBigPagesSize</span> <span class="o">=</span> <span class="mh">0x18</span>
</span></span><span class="line"><span class="cl">  <span class="nx">Print</span><span class="p">(</span><span class="nx">dlog</span><span class="p">,</span> <span class="s2">&#34;Big Pool Table Size : &#34;</span><span class="p">,</span><span class="nx">PoolTrackerBigPagesSize</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">dlog</span><span class="p">(</span><span class="s2">&#34;BaseOffset&#34;</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="s2">&#34;Offset&#34;</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="s2">&#34;Key&#34;</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="s2">&#34;Pattern&#34;</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="s2">&#34;Type&#34;</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="s2">&#34;SlushSize&#34;</span><span class="p">,</span> <span class="s2">&#34;\t\t&#34;</span><span class="p">,</span> <span class="s2">&#34;NumberOfBytes&#34;</span><span class="p">,</span> <span class="s2">&#34;\n&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">dlog</span><span class="p">(</span><span class="s2">&#34;-----------------------------------------------------------------------------------------\n&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">idx</span> <span class="o">&lt;</span> <span class="nx">bigPoolTableSize</span><span class="p">;</span> <span class="nx">idx</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">offset</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">host</span><span class="p">.</span><span class="nx">parseInt64</span><span class="p">(</span> <span class="nx">BigInt</span><span class="p">(</span><span class="nx">host</span><span class="p">.</span><span class="nx">memory</span><span class="p">.</span><span class="nx">readMemoryValues</span><span class="p">(</span><span class="nx">bigPoolTableAddress</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">false</span><span class="p">))</span> <span class="o">+</span> <span class="nx">BigInt</span><span class="p">(</span><span class="nx">PoolTrackerBigPagesSize</span><span class="p">)</span> <span class="o">*</span> <span class="nx">BigInt</span><span class="p">(</span><span class="nx">idx</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">      <span class="nx">DecodeBigPool</span><span class="p">(</span><span class="nx">offset</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Run the script</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="mi">0</span><span class="o">:</span> <span class="nx">kd</span><span class="o">&gt;</span> <span class="p">.</span><span class="nx">scriptrun</span> <span class="nx">E</span><span class="o">:</span><span class="err">\</span><span class="nx">bigPools</span><span class="p">.</span><span class="nx">js</span>
</span></span><span class="line"><span class="cl"><span class="nx">Initialized</span> <span class="nx">Script</span>
</span></span><span class="line"><span class="cl"><span class="nx">JavaScript</span> <span class="nx">script</span> <span class="nx">successfully</span> <span class="nx">loaded</span> <span class="nx">from</span> <span class="s1">&#39;E:\bigPools.js&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">Pool</span> <span class="nx">Table</span> <span class="nx">Entries</span> <span class="nx">Address</span> <span class="o">:</span> <span class="mh">0xfffff8054ee16a68</span>
</span></span><span class="line"><span class="cl"><span class="nx">Big</span> <span class="nx">Pool</span> <span class="nx">Table</span> <span class="nx">Base</span> <span class="nx">Address</span> <span class="o">:</span> <span class="mh">0xffffb58593e6f000</span>
</span></span><span class="line"><span class="cl"><span class="nx">Big</span> <span class="nx">Pool</span> <span class="nx">Table</span> <span class="nx">Base</span> <span class="nx">Size</span> <span class="o">:</span> <span class="mh">0x4000</span>
</span></span><span class="line"><span class="cl"><span class="nx">Big</span> <span class="nx">Pool</span> <span class="nx">Table</span> <span class="nx">Size</span> <span class="o">:</span> <span class="mh">0x18</span>
</span></span><span class="line"><span class="cl"><span class="nx">BaseOffset</span>				<span class="nx">Offset</span>					<span class="nx">Key</span>			<span class="nx">Pattern</span>	  <span class="nx">Type</span>	<span class="nx">SlushSize</span>	<span class="nx">NumberOfBytes</span>
</span></span><span class="line"><span class="cl"><span class="o">------------------------------------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593e6f000</span>		<span class="mh">0xffffc7065d778000</span>		<span class="nx">MmRe</span>		<span class="mi">0</span>		<span class="mi">1</span>		<span class="mi">64</span>		<span class="mh">0x8000</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593e6f018</span>		<span class="mh">0xffffb585977f7000</span>		<span class="nx">smBt</span>		<span class="mi">0</span>		<span class="mi">0</span>		<span class="mi">32</span>		<span class="mh">0x1000</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593e6f060</span>		<span class="mh">0xffffc70658df4000</span>		<span class="nx">CM25</span>		<span class="mi">0</span>		<span class="mi">5</span>		<span class="mi">0</span>		<span class="mh">0x1000</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593e6f078</span>		<span class="mh">0xffffd880bc354000</span>		<span class="nx">ConT</span>		<span class="mi">0</span>		<span class="mi">0</span>		<span class="mi">32</span>		<span class="mh">0x3000</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593e6f090</span>		<span class="mh">0xffffc70658932000</span>		<span class="nx">CM25</span>		<span class="mi">0</span>		<span class="mi">5</span>		<span class="mi">0</span>		<span class="mh">0x1000</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593e6f0a8</span>		<span class="mh">0xffffc706586d1000</span>		<span class="nx">CM25</span>		<span class="mi">0</span>		<span class="mi">5</span>		<span class="mi">0</span>		<span class="mh">0x1000</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593e6f0c0</span>		<span class="mh">0xffffc70658b93000</span>		<span class="nx">CM25</span>		<span class="mi">0</span>		<span class="mi">5</span>		<span class="mi">0</span>		<span class="mh">0x1000</span>
</span></span><span class="line"><span class="cl"><span class="p">....</span>
</span></span><span class="line"><span class="cl"><span class="p">....</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593eceee0</span>		<span class="mh">0xffffc7065e165000</span>		<span class="nx">Vi25</span>		<span class="mi">0</span>		<span class="mi">1</span>		<span class="mi">0</span>		<span class="mh">0x3000</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593eceef8</span>		<span class="mh">0xffffb585979c3001</span>		<span class="nx">smWw</span>		<span class="mi">0</span>		<span class="mi">0</span>		<span class="mi">32</span>		<span class="mh">0x1000</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593ecef70</span>		<span class="mh">0xffffc7065b6ce000</span>		<span class="nx">CM16</span>		<span class="mi">0</span>		<span class="mi">1</span>		<span class="mi">0</span>		<span class="mh">0x1000</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593ecef88</span>		<span class="mh">0xffffd880bc16e000</span>		<span class="nx">ConT</span>		<span class="mi">0</span>		<span class="mi">0</span>		<span class="mi">32</span>		<span class="mh">0x3000</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593ecefa0</span>		<span class="mh">0xffffc7065f6ce001</span>		<span class="nx">MmSt</span>		<span class="mi">0</span>		<span class="mi">1</span>		<span class="mi">0</span>		<span class="mh">0x2530</span>
</span></span><span class="line"><span class="cl"><span class="mh">0xffffb58593ecefe8</span>		<span class="mh">0xffffb585945a8001</span>		<span class="nx">Mmxx</span>		<span class="mi">0</span>		<span class="mi">0</span>		<span class="mi">96</span>		<span class="mh">0x1e000</span>
</span></span></code></pre></div><p>It saves the log file at the path. Check the log file for detailed analysis.</p>
<p><img alt="Image" loading="lazy" src="/posts/windows-bigpools/image1.png"></p>
<img src="https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExZnh5enpseHVncGMxM3BjcmFwY2ZnejM0c2s4b3Y2anczODN2bGJ6ZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/FWAcpJsFT9mvrv0e7a/giphy.gif"  alt="Heh GIF"  width="200" height="200">

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/windows-internals/">Windows Internals</a></li>
      <li><a href="http://localhost:1313/tags/memory-management/">Memory Management</a></li>
      <li><a href="http://localhost:1313/tags/kernel-debugging/">Kernel Debugging</a></li>
      <li><a href="http://localhost:1313/tags/bigpool/">BigPool</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/prefetch/prefetch/">
    <span class="title">« Prev</span>
    <br>
    <span>Prefetch Files</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/windows-objects/">
    <span class="title">Next »</span>
    <br>
    <span>Windows Objects: Structure, Headers, and Internal Mechanics</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Windows Bigpools on x"
            href="https://x.com/intent/tweet/?text=Windows%20Bigpools&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwindows-bigpools%2fwindows-bigpools%2f&amp;hashtags=WindowsInternals%2cMemoryManagement%2cKernelDebugging%2cBigPool">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Windows Bigpools on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwindows-bigpools%2fwindows-bigpools%2f&amp;title=Windows%20Bigpools&amp;summary=Windows%20Bigpools&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fwindows-bigpools%2fwindows-bigpools%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Windows Bigpools on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwindows-bigpools%2fwindows-bigpools%2f&title=Windows%20Bigpools">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Windows Bigpools on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwindows-bigpools%2fwindows-bigpools%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Windows Bigpools on whatsapp"
            href="https://api.whatsapp.com/send?text=Windows%20Bigpools%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fwindows-bigpools%2fwindows-bigpools%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Windows Bigpools on telegram"
            href="https://telegram.me/share/url?text=Windows%20Bigpools&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fwindows-bigpools%2fwindows-bigpools%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Windows Bigpools on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Windows%20Bigpools&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fwindows-bigpools%2fwindows-bigpools%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">shark.exe</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
