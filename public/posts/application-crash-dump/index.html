<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>Application Crash Dump Analysis :: 5h4rrk </title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="This post explores application dumps, a crucial tool for debugging and analyzing software errors, offering insights into memory analysis and troubleshooting techniques" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="http://localhost:1313/posts/application-crash-dump/" />







  
  
  
  
  
  <link rel="stylesheet" href="http://localhost:1313/styles.css">







  <link rel="shortcut icon" href="http://localhost:1313/img/theme-colors/orange.png">
  <link rel="apple-touch-icon" href="http://localhost:1313/img/theme-colors/orange.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Application Crash Dump Analysis">
<meta property="og:description" content="This post explores application dumps, a crucial tool for debugging and analyzing software errors, offering insights into memory analysis and troubleshooting techniques" />
<meta property="og:url" content="http://localhost:1313/posts/application-crash-dump/" />
<meta property="og:site_name" content="5h4rrk " />

  
    <meta property="og:image" content="http://localhost:1313/img/favicon/orange.png">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-02-07 07:38:39 &#43;0530 IST" />













  


</head>
<body class="orange">




<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/posts">
  <div class="logo">
    shark.exe [0]
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/tags">Tags</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/tags" >Tags</a></li>
        
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="http://localhost:1313/posts/application-crash-dump/">Application Crash Dump Analysis</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-02-07</time>
    
</div>

  
    <span class="post-tags">
      
      #<a href="http://localhost:1313/tags/crash-dump/">Crash Dump</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/windows-troubleshooting/">Windows Troubleshooting</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/dump-analysis/">Dump Analysis</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/windbg/">WinDbg</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/windows/">Windows</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/application-errors/">Application Errors</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/memory-analysis/">Memory Analysis</a>&nbsp;
      
    </span>
  
  



  

  <div class="post-content"><div>
        <h3 id="faulty-code">Faulty Code<a href="#faulty-code" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;windows.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">hDoRemaining</span><span class="p">(</span><span class="n">HANDLE</span> <span class="n">hdle</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">payload</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">hdle</span> <span class="o">!=</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">CloseHandle</span><span class="p">(</span><span class="n">hdle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">CloseHandle</span><span class="p">(</span><span class="n">hdle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">auto</span> <span class="n">cPayload</span> <span class="o">=</span> <span class="n">payload</span><span class="p">.</span><span class="nf">c_str</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">DWORD</span> <span class="n">bytesWritten</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nf">WriteFile</span><span class="p">(</span><span class="n">hdle</span><span class="p">,</span> <span class="n">cPayload</span><span class="p">,</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">cPayload</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">bytesWritten</span><span class="p">,</span> <span class="n">nullptr</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Payload / bytesWritten &#34;</span> <span class="o">&lt;&lt;</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">cPayload</span><span class="p">)</span> <span class="o">/</span> <span class="n">bytesWritten</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">hIsWriteable</span><span class="p">(</span><span class="n">HANDLE</span> <span class="n">hdle</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">payload</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">hdle</span> <span class="o">!=</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">DWORD</span> <span class="n">bytesWritten</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">cPayload</span> <span class="o">=</span> <span class="n">payload</span><span class="p">.</span><span class="nf">c_str</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nf">WriteFile</span><span class="p">(</span><span class="n">hdle</span><span class="p">,</span> <span class="n">cPayload</span><span class="p">,</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">cPayload</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">bytesWritten</span><span class="p">,</span> <span class="n">nullptr</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nf">hDoRemaining</span><span class="p">(</span><span class="n">hdle</span><span class="p">,</span> <span class="n">payload</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>   
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">hCreateFile</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">payload</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">auto</span> <span class="n">hdle</span> <span class="o">=</span> <span class="nf">CreateFileA</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;access.log&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">GENERIC_WRITE</span> <span class="o">|</span> <span class="n">GENERIC_READ</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">nullptr</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">CREATE_ALWAYS</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">FILE_ATTRIBUTE_NORMAL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">nullptr</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">hIsWriteable</span><span class="p">(</span><span class="n">hdle</span><span class="p">,</span> <span class="n">payload</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="nf">doXor</span><span class="p">(</span><span class="kt">char</span> <span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">payload</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="nf">out</span><span class="p">(</span><span class="n">payload</span><span class="p">.</span><span class="nf">size</span><span class="p">(),</span> <span class="sc">&#39;\0&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">payload</span><span class="p">.</span><span class="nf">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">payload</span><span class="o">=</span> <span class="s">&#34;127.0.0.1 - jane [21/Apr/2023:13:05:11 -0700] GET / index.html HTTP / 1.1 200 2326&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">auto</span> <span class="n">output</span> <span class="o">=</span> <span class="nf">doXor</span><span class="p">(</span><span class="mh">0x99</span><span class="p">,</span> <span class="n">payload</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nf">hCreateFile</span><span class="p">(</span><span class="n">output</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">std</span><span class="o">::</span><span class="nf">println</span><span class="p">(</span><span class="s">&#34;Writing Successful&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ul>
<li>
<p><strong>Double Closing the Handle</strong>: The main error here is that the handle is closed before it&rsquo;s used. Specifically, CloseHandle(hdle) is called twice - once unconditionally before <code>WriteFile</code> is invoked, and again at the end. This causes a double closing of the handle, making it invalid for the WriteFile function.</p>
</li>
<li>
<p><strong>Division by Zero Risk</strong>: The handle closing causes division by zero (i.e. bytesWritten=0).</p>
</li>
</ul>
<h3 id="procdump-setup">Procdump Setup<a href="#procdump-setup" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt;_  SysinternalsSuite ➜  .<span class="se">\p</span>rocdump.exe -ma -i E:<span class="se">\C</span>odes<span class="se">\D</span>ebugApplication<span class="se">\D</span>umps<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>
</span></span><span class="line"><span class="cl">ProcDump v11.0 - Sysinternals process dump utility
</span></span><span class="line"><span class="cl">Copyright <span class="o">(</span>C<span class="o">)</span> 2009-2022 Mark Russinovich and Andrew Richards
</span></span><span class="line"><span class="cl">Sysinternals - www.sysinternals.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Set to:
</span></span><span class="line"><span class="cl">  HKLM<span class="se">\S</span>OFTWARE<span class="se">\M</span>icrosoft<span class="se">\W</span>indows NT<span class="se">\C</span>urrentVersion<span class="se">\A</span>eDebug
</span></span><span class="line"><span class="cl">    <span class="o">(</span>REG_SZ<span class="o">)</span> <span class="nv">Auto</span>     <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">    <span class="o">(</span>REG_SZ<span class="o">)</span> <span class="nv">Debugger</span> <span class="o">=</span> <span class="s2">&#34;C:\Tools\SysinternalsSuite\procdump.exe&#34;</span> -accepteula -ma -j <span class="s2">&#34;E:\Codes\DebugApplication\Dumps&#34;</span> %ld %ld %p
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Set to:
</span></span><span class="line"><span class="cl">  HKLM<span class="se">\S</span>OFTWARE<span class="se">\W</span>ow6432Node<span class="se">\M</span>icrosoft<span class="se">\W</span>indows NT<span class="se">\C</span>urrentVersion<span class="se">\A</span>eDebug
</span></span><span class="line"><span class="cl">    <span class="o">(</span>REG_SZ<span class="o">)</span> <span class="nv">Auto</span>     <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">    <span class="o">(</span>REG_SZ<span class="o">)</span> <span class="nv">Debugger</span> <span class="o">=</span> <span class="s2">&#34;C:\Tools\SysinternalsSuite\procdump.exe&#34;</span> -accepteula -ma -j <span class="s2">&#34;E:\Codes\DebugApplication\Dumps&#34;</span> %ld %ld %p
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ProcDump is now <span class="nb">set</span> as the Just-in-time <span class="o">(</span>AeDebug<span class="o">)</span> debugger.
</span></span></code></pre></div><p>Install and set the dump path to <code>E:\Codes\DebugApplication\Dumps</code></p>
<p>or it can be changed through Registry</p>
<p><img src="/posts/application-crash-dump/image-1.png" alt="alt text"></p>
<p>Compile and Run it. Upon program termination due to an unhandled exception, a core dump  will be automatically saved to disk.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> ╰─λ ls
</span></span><span class="line"><span class="cl">DebugApplication.exe_250205_084645.dmp  DebugApplication.exe_250205_084646.dmp
</span></span></code></pre></div><p>After getting dump, Set the <code>Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AeDebug</code></p>
<ul>
<li><code>Auto</code> to 0.</li>
</ul>
<p>Load the generated dump file in windbg for analysis.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0:000&gt; !analyze -v
</span></span><span class="line"><span class="cl">*******************************************************************************
</span></span><span class="line"><span class="cl">*                                                                             *
</span></span><span class="line"><span class="cl">*                        Exception Analysis                                   *
</span></span><span class="line"><span class="cl">*                                                                             *
</span></span><span class="line"><span class="cl">*******************************************************************************
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">KEY_VALUES_STRING: <span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.CPU.mSec
</span></span><span class="line"><span class="cl">    Value: <span class="m">546</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.Elapsed.mSec
</span></span><span class="line"><span class="cl">    Value: <span class="m">41995</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.IO.Other.Mb
</span></span><span class="line"><span class="cl">    Value: <span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.IO.Read.Mb
</span></span><span class="line"><span class="cl">    Value: <span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.IO.Write.Mb
</span></span><span class="line"><span class="cl">    Value: <span class="m">6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.Init.CPU.mSec
</span></span><span class="line"><span class="cl">    Value: <span class="m">625</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.Init.Elapsed.mSec
</span></span><span class="line"><span class="cl">    Value: <span class="m">7396</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.Memory.CommitPeak.Mb
</span></span><span class="line"><span class="cl">    Value: <span class="m">92</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.Version.DbgEng
</span></span><span class="line"><span class="cl">    Value: 10.0.27725.1000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.Version.Description
</span></span><span class="line"><span class="cl">    Value: 10.2408.27.01 amd64fre
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Analysis.Version.Ext
</span></span><span class="line"><span class="cl">    Value: 1.2408.27.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Failure.Bucket
</span></span><span class="line"><span class="cl">    Value: INTEGER_DIVIDE_BY_ZERO_c0000094_DebugApplication.exe!hDoRemaining
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Failure.Hash
</span></span><span class="line"><span class="cl">    Value: <span class="o">{</span>eb875f65-3c8b-ba45-7fb3-ce4ffd1e8c9d<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Timeline.OS.Boot.DeltaSec
</span></span><span class="line"><span class="cl">    Value: <span class="m">61256</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : Timeline.Process.Start.DeltaSec
</span></span><span class="line"><span class="cl">    Value: <span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : WER.OS.Branch
</span></span><span class="line"><span class="cl">    Value: ge_release
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Key  : WER.OS.Version
</span></span><span class="line"><span class="cl">    Value: 10.0.26100.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FILE_IN_CAB:  DebugApplication.exe_250205_084645.dmp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">COMMENT:  
</span></span><span class="line"><span class="cl">*** <span class="s2">&#34;C:\Tools\SysinternalsSuite\procdump.exe&#34;</span> -accepteula -ma -j <span class="s2">&#34;E:\Codes\DebugApplication\Dumps&#34;</span> <span class="m">2496</span> <span class="m">620</span> 00000242E2740000
</span></span><span class="line"><span class="cl">*** Just-In-Time debugger. PID: <span class="m">2496</span> Event Handle: <span class="m">620</span> JIT Context: .jdinfo 0x242e2740000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NTGLOBALFLAG:  <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">APPLICATION_VERIFIER_FLAGS:  <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">CONTEXT:  <span class="o">(</span>.ecxr<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">rax</span><span class="o">=</span><span class="m">0000000000000052</span> <span class="nv">rbx</span><span class="o">=</span><span class="m">0000000000000000</span> <span class="nv">rcx</span><span class="o">=</span><span class="m">0000000000000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">rdx</span><span class="o">=</span><span class="m">0000000000000000</span> <span class="nv">rsi</span><span class="o">=</span><span class="m">0000000000000000</span> <span class="nv">rdi</span><span class="o">=</span>0000008171b2f538
</span></span><span class="line"><span class="cl"><span class="nv">rip</span><span class="o">=</span>00007ff7c2929e47 <span class="nv">rsp</span><span class="o">=</span>0000008171b2f460 <span class="nv">rbp</span><span class="o">=</span>0000008171b2f490
</span></span><span class="line"><span class="cl"> <span class="nv">r8</span><span class="o">=</span>7efefefefefefeff  <span class="nv">r9</span><span class="o">=</span>4ccccccccbffaeaa <span class="nv">r10</span><span class="o">=</span>00000242e2571ac0
</span></span><span class="line"><span class="cl"><span class="nv">r11</span><span class="o">=</span><span class="m">8101010101010100</span> <span class="nv">r12</span><span class="o">=</span><span class="m">0000000000000000</span> <span class="nv">r13</span><span class="o">=</span><span class="m">0000000000000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">r14</span><span class="o">=</span><span class="m">0000000000000000</span> <span class="nv">r15</span><span class="o">=</span><span class="m">0000000000000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">iopl</span><span class="o">=</span><span class="m">0</span>         nv up ei pl zr na po nc
</span></span><span class="line"><span class="cl"><span class="nv">cs</span><span class="o">=</span><span class="m">0033</span>  <span class="nv">ss</span><span class="o">=</span>002b  <span class="nv">ds</span><span class="o">=</span>002b  <span class="nv">es</span><span class="o">=</span>002b  <span class="nv">fs</span><span class="o">=</span><span class="m">0053</span>  <span class="nv">gs</span><span class="o">=</span>002b             <span class="nv">efl</span><span class="o">=</span><span class="m">00010246</span>
</span></span><span class="line"><span class="cl">DebugApplication!hDoRemaining+0xf7:
</span></span><span class="line"><span class="cl">00007ff7<span class="sb">`</span>c2929e47 48f7f1          div     rax,rcx
</span></span><span class="line"><span class="cl">Resetting default scope
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">EXCEPTION_RECORD:  <span class="o">(</span>.exr -1<span class="o">)</span>
</span></span><span class="line"><span class="cl">ExceptionAddress: 00007ff7c2929e47 <span class="o">(</span>DebugApplication!hDoRemaining+0x00000000000000f7<span class="o">)</span>
</span></span><span class="line"><span class="cl">   ExceptionCode: c0000094 <span class="o">(</span>Integer divide-by-zero<span class="o">)</span>
</span></span><span class="line"><span class="cl">  ExceptionFlags: <span class="m">00000000</span>
</span></span><span class="line"><span class="cl">NumberParameters: <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PROCESS_NAME:  DebugApplication.exe
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ERROR_CODE: <span class="o">(</span>NTSTATUS<span class="o">)</span> 0xc0000094 - <span class="o">{</span>EXCEPTION<span class="o">}</span>  Integer division by zero.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">EXCEPTION_CODE_STR:  c0000094
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">STACK_TEXT:  
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f460 00007ff7<span class="sb">`</span>c292a0a6     : 00000000<span class="sb">`</span>000000d8 00000081<span class="sb">`</span>71b2f768 00000000<span class="sb">`</span><span class="m">00000000</span> 00000081<span class="sb">`</span>71b2f644 : DebugApplication!hDoRemaining+0xf7
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f610 00007ff7<span class="sb">`</span>c2929cfd     : 00000000<span class="sb">`</span>000000d8 00000081<span class="sb">`</span>71b2f958 00000081<span class="sb">`</span>71b2fb40 00000000<span class="sb">`</span><span class="m">00000053</span> : DebugApplication!hIsWriteable+0xd6
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f810 00007ff7<span class="sb">`</span>c292aa01     : 00000081<span class="sb">`</span>71b2fb38 00000081<span class="sb">`</span>71b2fa38 00000081<span class="sb">`</span>71b2f9f8 00320070<span class="sb">`</span><span class="m">00700043</span> : DebugApplication!hCreateFile+0x8d
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f9d0 00007ff7<span class="sb">`</span>c2939879     : 000004ca<span class="sb">`</span><span class="m">00000001</span> 00007ff9<span class="sb">`</span>700825c8 00000000<span class="sb">`</span><span class="m">00000000</span> 00007ff7<span class="sb">`</span>c293b02d : DebugApplication!main+0x91
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fc20 00007ff7<span class="sb">`</span>c2939722     : 00007ff7<span class="sb">`</span>c2942000 00007ff7<span class="sb">`</span>c2942220 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> : DebugApplication!invoke_main+0x39
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fc70 00007ff7<span class="sb">`</span>c29395de     : 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> : DebugApplication!__scrt_common_main_seh+0x132
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fce0 00007ff7<span class="sb">`</span>c293990e     : 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> : DebugApplication!__scrt_common_main+0xe
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fd10 00007ffa<span class="sb">`</span>49c7e8d7     : 00000081<span class="sb">`</span>71cb0000 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> : DebugApplication!mainCRTStartup+0xe
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fd40 00007ffa<span class="sb">`</span>4b9bfbcc     : 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> 000004f0<span class="sb">`</span>fffffb30 000004d0<span class="sb">`</span>fffffb30 : kernel32!BaseThreadInitThunk+0x17
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fd70 00000000<span class="sb">`</span><span class="m">00000000</span>     : 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> 00000000<span class="sb">`</span><span class="m">00000000</span> : ntdll!RtlUserThreadStart+0x2c
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">STACK_COMMAND:  ~0s<span class="p">;</span> .ecxr <span class="p">;</span> kb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FAULTING_SOURCE_LINE:  E:<span class="se">\C</span>odes<span class="se">\D</span>ebugApplication<span class="se">\D</span>ebugApplication<span class="se">\D</span>ebugApplication.cpp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FAULTING_SOURCE_FILE:  E:<span class="se">\C</span>odes<span class="se">\D</span>ebugApplication<span class="se">\D</span>ebugApplication<span class="se">\D</span>ebugApplication.cpp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FAULTING_SOURCE_LINE_NUMBER:  <span class="m">15</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FAULTING_SOURCE_CODE:  
</span></span><span class="line"><span class="cl">    11:     DWORD bytesWritten<span class="p">;</span>
</span></span><span class="line"><span class="cl">    12:     <span class="k">if</span> <span class="o">(</span>WriteFile<span class="o">(</span>hdle, cPayload, strlen<span class="o">(</span>cPayload<span class="o">)</span>, <span class="p">&amp;</span>bytesWritten, nullptr<span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    13:         <span class="k">return</span> true<span class="p">;</span>
</span></span><span class="line"><span class="cl">    14:     <span class="o">}</span>
</span></span><span class="line"><span class="cl">&gt;   15:     std::cout &lt;&lt; <span class="s2">&#34;Payload / bytesWritten &#34;</span> <span class="s">&lt;&lt; strlen(cPayload) / bytesWritten &lt;&lt; std::endl;
</span></span></span><span class="line"><span class="cl"><span class="s">    16:     return true;
</span></span></span><span class="line"><span class="cl"><span class="s">    17: }
</span></span></span><span class="line"><span class="cl"><span class="s">    18: 
</span></span></span><span class="line"><span class="cl"><span class="s">    19: 
</span></span></span><span class="line"><span class="cl"><span class="s">    20: bool hIsWriteable(HANDLE hdle, std::str</span>ing payload<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SYMBOL_NAME:  DebugApplication!hDoRemaining+f7
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MODULE_NAME: DebugApplication
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">IMAGE_NAME:  DebugApplication.exe
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FAILURE_BUCKET_ID:  INTEGER_DIVIDE_BY_ZERO_c0000094_DebugApplication.exe!hDoRemaining
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">OS_VERSION:  10.0.26100.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">BUILDLAB_STR:  ge_release
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">OSPLATFORM_TYPE:  x64
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">OSNAME:  Windows <span class="m">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FAILURE_ID_HASH:  <span class="o">{</span>eb875f65-3c8b-ba45-7fb3-ce4ffd1e8c9d<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Followup:     MachineOwner
</span></span><span class="line"><span class="cl">---------
</span></span></code></pre></div><p><code>.exr</code>: displays various information about exception record like ExceptionAddress, ExceptionCode, ExceptionFlags and NumberofParameters.</p>
<p>To display the most recent exception record. Use <code>.exr -1</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0:000&gt; .exr -1
</span></span><span class="line"><span class="cl">ExceptionAddress: 00007ff7c2929e47 <span class="o">(</span>DebugApplication!hDoRemaining+0x00000000000000f7<span class="o">)</span>
</span></span><span class="line"><span class="cl">   ExceptionCode: c0000094 <span class="o">(</span>Integer divide-by-zero<span class="o">)</span>
</span></span><span class="line"><span class="cl">  ExceptionFlags: <span class="m">00000000</span>
</span></span><span class="line"><span class="cl">NumberParameters: <span class="m">0</span>
</span></span></code></pre></div><h4 id="debugger-output-line">Debugger Output Line<a href="#debugger-output-line" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">                                          +---------------+-----------------+-----------------+-----------------+
</span></span><span class="line"><span class="cl">                                          <span class="p">|</span>       RCX     <span class="p">|</span>        RDX      <span class="p">|</span>     R8          <span class="p">|</span>    R9           <span class="p">|</span>
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f810 00007ff7<span class="sb">`</span>c292aa01     : 00000081<span class="sb">`</span>71b2fb38 00000081<span class="sb">`</span>71b2fa38 00000081<span class="sb">`</span>71b2f9f8 00320070<span class="sb">`</span><span class="m">00700043</span> : DebugApplication!hCreateFile+0x8d
</span></span></code></pre></div><h5 id="register-inspections">Register Inspections<a href="#register-inspections" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<p>Let&rsquo;s Inspect the register values while calling the function.</p>
<p><strong>Inspecting RDX</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0:000&gt; db 00000081<span class="sb">`</span>71b2fa38
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa38  <span class="m">60</span> c9 <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> 00-c0 d9 <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> <span class="m">00</span>  <span class="sb">`</span>.W.B.....W.B...
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa48  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-52 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ........R.......
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa58  5f <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-cc cc cc cc cc cc cc cc  _...............
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa68  cc cc cc cc cc cc cc cc-cc cc cc cc cc cc cc cc  ................
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa78  cc cc cc cc cc cc cc cc-cc cc cc cc cc cc cc cc  ................
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa88  cc cc cc cc cc cc cc cc-cc cc cc cc cc cc cc cc  ................
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa98  cc cc cc cc cc cc cc cc-cc cc cc cc cc cc cc cc  ................
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2faa8  cc cc cc cc cc cc cc cc-cc cc cc cc cc cc cc cc  ................
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0:000&gt; db poi<span class="o">(</span>00000081<span class="sb">`</span>71b2fa38+0x8<span class="o">)</span>
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d9c0  a8 ab ae b7 a9 b7 a9 b7-a8 b9 b4 b9 f3 f8 f7 <span class="nb">fc</span>  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d9d0  b9 c2 ab a8 b6 d8 e9 eb-b6 ab a9 ab aa a3 a8 aa  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d9e0  a3 a9 ac a3 a8 a8 b9 b4-a9 ae a9 a9 c4 b9 de dc  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d9f0  <span class="nb">cd</span> b9 b6 b9 f0 f7 fd fc-e1 b7 f1 ed f4 f5 b9 d1  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257da00  <span class="nb">cd</span> <span class="nb">cd</span> c9 b9 b6 b9 a8 b7-a8 b9 ab a9 a9 b9 ab aa  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257da10  ab af <span class="m">00</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> cd-cd <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span>  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257da20  fd fd fd fd <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-e5 <span class="m">54</span> <span class="m">35</span> <span class="m">34</span> <span class="m">00</span> <span class="m">10</span> <span class="m">00</span> <span class="m">80</span>  .........T54....
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257da30  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span></code></pre></div><p><strong>Inspecting R8</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0:000&gt; db 00000081<span class="sb">`</span>71b2f9f8
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f9f8  <span class="m">50</span> ca <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> 00-c0 d4 <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> <span class="m">00</span>  P.W.B.....W.B...
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa08  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-52 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ........R.......
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa18  5f <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-cc cc cc cc cc cc cc cc  _...............
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa28  cc cc cc cc cc cc cc cc-cc cc cc cc cc cc cc cc  ................
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa38  <span class="m">60</span> c9 <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> 00-c0 d9 <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> <span class="m">00</span>  <span class="sb">`</span>.W.B.....W.B...
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa48  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-52 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ........R.......
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa58  5f <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-cc cc cc cc cc cc cc cc  _...............
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fa68  cc cc cc cc cc cc cc cc-cc cc cc cc cc cc cc cc  ................
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0:000&gt; db poi<span class="o">(</span>00000081<span class="sb">`</span>71b2f9f8+0x8<span class="o">)</span>
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d4c0  <span class="m">31</span> <span class="m">32</span> <span class="m">37</span> 2e <span class="m">30</span> 2e <span class="m">30</span> 2e-31 <span class="m">20</span> 2d <span class="m">20</span> 6a <span class="m">61</span> 6e <span class="m">65</span>  127.0.0.1 - jane
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d4d0  <span class="m">20</span> 5b <span class="m">32</span> <span class="m">31</span> 2f <span class="m">41</span> <span class="m">70</span> 72-2f <span class="m">32</span> <span class="m">30</span> <span class="m">32</span> <span class="m">33</span> 3a <span class="m">31</span> <span class="m">33</span>   <span class="o">[</span>21/Apr/2023:13
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d4e0  3a <span class="m">30</span> <span class="m">35</span> 3a <span class="m">31</span> <span class="m">31</span> <span class="m">20</span> 2d-30 <span class="m">37</span> <span class="m">30</span> <span class="m">30</span> 5d <span class="m">20</span> <span class="m">47</span> <span class="m">45</span>  :05:11 -0700<span class="o">]</span> GE
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d4f0  <span class="m">54</span> <span class="m">20</span> 2f <span class="m">20</span> <span class="m">69</span> 6e <span class="m">64</span> 65-78 2e <span class="m">68</span> <span class="m">74</span> 6d 6c <span class="m">20</span> <span class="m">48</span>  T / index.html H
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d500  <span class="m">54</span> <span class="m">54</span> <span class="m">50</span> <span class="m">20</span> 2f <span class="m">20</span> <span class="m">31</span> 2e-31 <span class="m">20</span> <span class="m">32</span> <span class="m">30</span> <span class="m">30</span> <span class="m">20</span> <span class="m">32</span> <span class="m">33</span>  TTP / 1.1 <span class="m">200</span> <span class="m">23</span>
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d510  <span class="m">32</span> <span class="m">36</span> <span class="m">00</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> cd-cd <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span>  26..............
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d520  fd fd fd fd <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-15 <span class="m">54</span> c5 <span class="m">34</span> <span class="m">00</span> <span class="m">08</span> <span class="m">00</span> <span class="m">80</span>  .........T.4....
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d530  5c <span class="m">00</span> 3f <span class="m">00</span> 3f <span class="m">00</span> 5c 00-45 <span class="m">00</span> 3a <span class="m">00</span> 5c <span class="m">00</span> <span class="m">30</span> <span class="m">00</span>  <span class="se">\.</span>?.?.<span class="se">\.</span>E.:.<span class="se">\.</span>0.
</span></span></code></pre></div><h5 id="decrypt-the-original-content">Decrypt the original content<a href="#decrypt-the-original-content" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<p><strong>Inspecting RCX</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0:000&gt; db 8171b2fb38
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fb38  <span class="m">40</span> cb <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> 00-e0 d7 <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> <span class="m">00</span>  @.W.B.....W.B...
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fb48  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-52 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ........R.......
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fb58  5f <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-fe ff ff ff ff ff ff ff  _...............
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fb68  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fb78  <span class="m">38</span> fb b2 <span class="m">71</span> <span class="m">81</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  8..q............
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fb88  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fb98  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2fba8  fb f6 <span class="m">00</span> <span class="m">70</span> f9 7f <span class="m">00</span> 00-00 b3 1e <span class="m">70</span> f9 7f <span class="m">00</span> <span class="m">00</span>  ...p.......p....
</span></span></code></pre></div><ul>
<li>
<p>[0:8] : Unknown(stores the address) -&gt; that points to same address <strong>00000081`71b2fb38</strong></p>
</li>
<li>
<p>[8:16] : PayloadAddress</p>
</li>
<li>
<p>[16:24] : Unknown (NULL)</p>
</li>
<li>
<p>[24:32] : PayloadSize</p>
</li>
<li>
<p>[32:40] : Allocated Size (aligned with power of 2)</p>
</li>
<li>
<p><strong>Payload Address</strong>: 0x020242e757d0e</p>
</li>
<li>
<p><strong>Payload Size</strong>: 0x52</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0:000&gt; db 0242e257d7e0
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d7e0  a8 ab ae b7 a9 b7 a9 b7-a8 b9 b4 b9 f3 f8 f7 <span class="nb">fc</span>  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d7f0  b9 c2 ab a8 b6 d8 e9 eb-b6 ab a9 ab aa a3 a8 aa  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d800  a3 a9 ac a3 a8 a8 b9 b4-a9 ae a9 a9 c4 b9 de dc  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d810  <span class="nb">cd</span> b9 b6 b9 f0 f7 fd fc-e1 b7 f1 ed f4 f5 b9 d1  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d820  <span class="nb">cd</span> <span class="nb">cd</span> c9 b9 b6 b9 a8 b7-a8 b9 ab a9 a9 b9 ab aa  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d830  ab af <span class="m">00</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> cd-cd <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span>  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d840  fd fd fd fd <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-c3 <span class="m">54</span> <span class="m">17</span> <span class="m">34</span> <span class="m">00</span> 0d <span class="m">00</span> 8c  .........T.4....
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d850  d0 c9 <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> 00-a0 aa <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> <span class="m">00</span>  ..W.B.....W.B...
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0:000&gt; db 0242e257d7e0 L52
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d7e0  a8 ab ae b7 a9 b7 a9 b7-a8 b9 b4 b9 f3 f8 f7 <span class="nb">fc</span>  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d7f0  b9 c2 ab a8 b6 d8 e9 eb-b6 ab a9 ab aa a3 a8 aa  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d800  a3 a9 ac a3 a8 a8 b9 b4-a9 ae a9 a9 c4 b9 de dc  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d810  <span class="nb">cd</span> b9 b6 b9 f0 f7 fd fc-e1 b7 f1 ed f4 f5 b9 d1  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d820  <span class="nb">cd</span> <span class="nb">cd</span> c9 b9 b6 b9 a8 b7-a8 b9 ab a9 a9 b9 ab aa  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257d830  ab af  
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">hex_bytes</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xb4</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xfc</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xc2</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0xeb</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xb4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xc4</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0xfc</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0xf4</span><span class="p">,</span> <span class="mh">0xf5</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xaf</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">hex_bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">xor_result</span> <span class="o">=</span> <span class="n">byte</span> <span class="o">^</span> <span class="mh">0x99</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">xor_result</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  
</span></span></code></pre></div><p><strong>Output</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">127.0.0.1 - jane <span class="o">[</span>21/Apr/2023:13:05:11 -0700<span class="o">]</span> GET / index.html HTTP / 1.1 <span class="m">200</span> <span class="m">2326</span>
</span></span></code></pre></div><h4 id="debugger-output-line-1">Debugger Output Line<a href="#debugger-output-line-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">        00000081<span class="sb">`</span>71b2f610 00007ff7<span class="sb">`</span>c2929cfd     : 00000000<span class="sb">`</span>000000d8 00000081<span class="sb">`</span>71b2f958 00000081<span class="sb">`</span>71b2fb40 00000000<span class="sb">`</span><span class="m">00000053</span> : DebugApplication!hIsWriteable+0xd6
</span></span></code></pre></div><ul>
<li>Handle Value : <strong>00000000`000000d8</strong></li>
<li>Payload: <strong>00000081`71b2f958</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0:000&gt; db 00000081<span class="sb">`</span>71b2f958
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f958  <span class="m">90</span> cb <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> 00-60 df <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> <span class="m">00</span>  ..W.B...<span class="sb">`</span>.W.B...
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f968  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-52 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ........R.......
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f978  5f <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">91</span> c2 <span class="m">00</span> 7f <span class="m">00</span> <span class="m">00</span>  _...............
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f988  <span class="m">00</span> e0 <span class="m">04</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">01</span> <span class="m">01</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f998  <span class="m">58</span> f9 b2 <span class="m">71</span> <span class="m">81</span> <span class="m">00</span> <span class="m">00</span> 00-c0 d9 <span class="m">57</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> <span class="m">00</span>  X..q......W.B...
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f9a8  <span class="m">58</span> f9 b2 <span class="m">71</span> <span class="m">81</span> <span class="m">00</span> <span class="m">00</span> 00-9f a0 <span class="m">95</span> c2 f7 7f <span class="m">00</span> <span class="m">00</span>  X..q............
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f9b8  <span class="m">40</span> fb b2 <span class="m">71</span> <span class="m">81</span> <span class="m">00</span> <span class="m">00</span> 00-f0 f9 b2 <span class="m">71</span> <span class="m">81</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  @..q.......q....
</span></span><span class="line"><span class="cl">00000081<span class="sb">`</span>71b2f9c8  <span class="m">01</span> aa <span class="m">92</span> c2 f7 7f <span class="m">00</span> 00-38 fb b2 <span class="m">71</span> <span class="m">81</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ........8..q....
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0:000&gt; db poi<span class="o">(</span>00000081<span class="sb">`</span>71b2f958+0x8<span class="o">)</span>
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257df60  a8 ab ae b7 a9 b7 a9 b7-a8 b9 b4 b9 f3 f8 f7 <span class="nb">fc</span>  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257df70  b9 c2 ab a8 b6 d8 e9 eb-b6 ab a9 ab aa a3 a8 aa  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257df80  a3 a9 ac a3 a8 a8 b9 b4-a9 ae a9 a9 c4 b9 de dc  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257df90  <span class="nb">cd</span> b9 b6 b9 f0 f7 fd fc-e1 b7 f1 ed f4 f5 b9 d1  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257dfa0  <span class="nb">cd</span> <span class="nb">cd</span> c9 b9 b6 b9 a8 b7-a8 b9 ab a9 a9 b9 ab aa  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257dfb0  ab af <span class="m">00</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> cd-cd <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span> <span class="nb">cd</span>  ................
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257dfc0  fd fd fd fd <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-04 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 7a <span class="m">00</span> <span class="m">00</span>  .............z..
</span></span><span class="line"><span class="cl">00000242<span class="sb">`</span>e257dfd0  f0 <span class="m">00</span> <span class="m">56</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> 00-f0 <span class="m">00</span> <span class="m">56</span> e2 <span class="m">42</span> <span class="m">02</span> <span class="m">00</span> <span class="m">00</span>  ..V.B.....V.B...
</span></span></code></pre></div>
      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h"></span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="http://localhost:1313/posts/windows-objects/">
                <span class="button__icon">←</span>
                <span class="button__text">Windows Objects: Structure, Headers, and Internal Mechanics</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="http://localhost:1313/posts/dumpanalysis/">
                <span class="button__text">Kernel Memory Dump Analysis : Introduction</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/mirus-ua/hugo-theme-re-terminal" target="_blank">Theme</a> made by <a href="https://github.com/mirus-ua" target="_blank">Mirus</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>








  
</div>

</body>
</html>
