<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>PE Parsing: A Step-by-Step Guide with WinDbg - Part 2 :: 5h4rrk </title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Hands on parsing PE files with WinDbg and explore their structures for debugging and reverse engineering." />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="http://localhost:1313/posts/pe-parse-windbg2/" />







  
  
  
  
  
  <link rel="stylesheet" href="http://localhost:1313/styles.css">







  <link rel="shortcut icon" href="http://localhost:1313/img/theme-colors/orange.png">
  <link rel="apple-touch-icon" href="http://localhost:1313/img/theme-colors/orange.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="PE Parsing: A Step-by-Step Guide with WinDbg - Part 2">
<meta property="og:description" content="Hands on parsing PE files with WinDbg and explore their structures for debugging and reverse engineering." />
<meta property="og:url" content="http://localhost:1313/posts/pe-parse-windbg2/" />
<meta property="og:site_name" content="5h4rrk " />

  
    <meta property="og:image" content="http://localhost:1313/img/favicon/orange.png">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-01-12 00:00:00 &#43;0000 UTC" />













  


</head>
<body class="orange">




<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/posts">
  <div class="logo">
    shark.exe [0]
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;â–¾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/tags">Tags</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/tags" >Tags</a></li>
        
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="http://localhost:1313/posts/pe-parse-windbg2/">PE Parsing: A Step-by-Step Guide with WinDbg - Part 2</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-01-12</time>
    
</div>

  
    <span class="post-tags">
      
      #<a href="http://localhost:1313/tags/windbg/">WinDbg</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/pe/">PE</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/portable-executable/">Portable Executable</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/pe-parsing/">PE Parsing</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/debugging/">Debugging</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/reverse-engineering/">Reverse Engineering</a>&nbsp;
      
      #<a href="http://localhost:1313/tags/windows-internals/">Windows Internals</a>&nbsp;
      
    </span>
  
  



  

  <div class="post-content"><div>
        <h4 id="pe-import-directory-parsing">PE Import Directory Parsing<a href="#pe-import-directory-parsing" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; !process <span class="m">0</span> <span class="m">0</span> msedge.exe
</span></span><span class="line"><span class="cl">PROCESS ffff81822cc0a080
</span></span><span class="line"><span class="cl">    SessionId: <span class="m">1</span>  Cid: 0f08    Peb: dbc4685000  ParentCid: 1b48
</span></span><span class="line"><span class="cl">    DirBase: 3f0ae002  ObjectTable: ffffcc89acaf8e40  HandleCount: 175.
</span></span><span class="line"><span class="cl">    Image: msedge.exe
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; .process /p /r ffff81822cc0a080
</span></span><span class="line"><span class="cl">Implicit process is now ffff8182<span class="sb">`</span>2cc0a080
</span></span><span class="line"><span class="cl">.cache forcedecodeuser <span class="k">done</span>
</span></span><span class="line"><span class="cl">Loading User Symbols
</span></span><span class="line"><span class="cl">.......................
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; lm v m HTTP
</span></span><span class="line"><span class="cl">Browse full module list
</span></span><span class="line"><span class="cl">start             end                 module name
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15e50000 fffff800<span class="sb">`</span>15fd8000   HTTP       <span class="o">(</span>no symbols<span class="o">)</span>           
</span></span><span class="line"><span class="cl">    Loaded symbol image file: HTTP.sys
</span></span><span class="line"><span class="cl">    Mapped memory image file: c:<span class="se">\p</span>rogramdata<span class="se">\d</span>bg<span class="se">\s</span>ym<span class="se">\H</span>TTP.sys<span class="se">\4</span>3E8008A188000<span class="se">\H</span>TTP.sys
</span></span><span class="line"><span class="cl">    Image path: <span class="se">\S</span>ystemRoot<span class="se">\s</span>ystem32<span class="se">\d</span>rivers<span class="se">\H</span>TTP.sys
</span></span><span class="line"><span class="cl">    Image name: HTTP.sys
</span></span><span class="line"><span class="cl">    Browse all global symbols  functions  data  Symbol Reload
</span></span><span class="line"><span class="cl">    Image was built with /Brepro flag.
</span></span><span class="line"><span class="cl">    Timestamp:        43E8008A <span class="o">(</span>This is a reproducible build file hash, not a timestamp<span class="o">)</span>
</span></span><span class="line"><span class="cl">    CheckSum:         00188BE7
</span></span><span class="line"><span class="cl">    ImageSize:        <span class="m">00188000</span>
</span></span><span class="line"><span class="cl">    Translations:     0000.04b0 0000.04e4 0409.04b0 0409.04e4
</span></span><span class="line"><span class="cl">    Information from resource tables: 
</span></span></code></pre></div><p>ImageName : HTTP.sys</p>
<p>ImageBaseAddress : <code>fffff80015e5000</code></p>
<p><code>/Brepo</code> flag : In the context of building C/C++ application, it is related to incremental linking and dependency tracking.</p>
<h4 id="parsing-it-manually">Parsing it Manually<a href="#parsing-it-manually" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<h5 id="_image_dos_header">_IMAGE_DOS_HEADER<a href="#_image_dos_header" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; db fffff800<span class="sb">`</span>15e50000
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15e50000  4d 5a <span class="m">90</span> <span class="m">00</span> <span class="m">03</span> <span class="m">00</span> <span class="m">00</span> 00-04 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> ff ff <span class="m">00</span> <span class="m">00</span>  MZ..............
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15e50010  b8 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-40 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ........@.......
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15e50020  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15e50030  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> 00-00 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> d8 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  ................
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_DOS_HEADER  fffff800<span class="sb">`</span>15e50000 
</span></span><span class="line"><span class="cl">   +0x000 e_magic          : 0x5a4d
</span></span><span class="line"><span class="cl">   +0x002 e_cblp           : 0x90
</span></span><span class="line"><span class="cl">   +0x004 e_cp             : <span class="m">3</span>
</span></span><span class="line"><span class="cl">   +0x006 e_crlc           : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x008 e_cparhdr        : <span class="m">4</span>
</span></span><span class="line"><span class="cl">   +0x00a e_minalloc       : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x00c e_maxalloc       : 0xffff
</span></span><span class="line"><span class="cl">   +0x00e e_ss             : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x010 e_sp             : 0xb8
</span></span><span class="line"><span class="cl">   +0x012 e_csum           : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x014 e_ip             : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x016 e_cs             : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x018 e_lfarlc         : 0x40
</span></span><span class="line"><span class="cl">   +0x01a e_ovno           : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x01c e_res            : <span class="o">[</span>4<span class="o">]</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x024 e_oemid          : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x026 e_oeminfo        : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x028 e_res2           : <span class="o">[</span>10<span class="o">]</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x03c e_lfanew         : 0n216
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; ? 0n216
</span></span><span class="line"><span class="cl">Evaluate expression: <span class="nv">216</span> <span class="o">=</span> 00000000<span class="sb">`</span>000000d8
</span></span></code></pre></div><h5 id="dos-stub--rich-header">DOS STUB &amp; RICH HEADER<a href="#dos-stub--rich-header" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fffff807<span class="sb">`</span>2a4a0040  0e 1f ba 0e <span class="m">00</span> b4 <span class="m">09</span> cd-21 b8 <span class="m">01</span> 4c <span class="nb">cd</span> <span class="m">21</span> <span class="m">54</span> <span class="m">68</span>  ........!..L.!Th
</span></span><span class="line"><span class="cl">fffff807<span class="sb">`</span>2a4a0050  <span class="m">69</span> <span class="m">73</span> <span class="m">20</span> <span class="m">70</span> <span class="m">72</span> 6f <span class="m">67</span> 72-61 6d <span class="m">20</span> <span class="m">63</span> <span class="m">61</span> 6e 6e 6f  is program canno
</span></span><span class="line"><span class="cl">fffff807<span class="sb">`</span>2a4a0060  <span class="m">74</span> <span class="m">20</span> <span class="m">62</span> <span class="m">65</span> <span class="m">20</span> <span class="m">72</span> <span class="m">75</span> 6e-20 <span class="m">69</span> 6e <span class="m">20</span> <span class="m">44</span> 4f <span class="m">53</span> <span class="m">20</span>  t be run in DOS 
</span></span><span class="line"><span class="cl">fffff807<span class="sb">`</span>2a4a0070  6d 6f <span class="m">64</span> <span class="m">65</span> 2e 0d 0d 0a-24 <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>  mode....$.......
</span></span><span class="line"><span class="cl">fffff807<span class="sb">`</span>2a4a0080  bd 0a c4 <span class="m">77</span> f9 6b aa 24-f9 6b aa <span class="m">24</span> f9 6b aa <span class="m">24</span>  ...w.k.$.k.$.k.$
</span></span><span class="line"><span class="cl">fffff807<span class="sb">`</span>2a4a0090  f9 6b ab <span class="m">24</span> <span class="m">53</span> 6a aa 24-ed <span class="m">00</span> ab <span class="m">25</span> f6 6b aa <span class="m">24</span>  .k.<span class="nv">$Sj</span>.$...%.k.$
</span></span><span class="line"><span class="cl">fffff807<span class="sb">`</span>2a4a00a0  ed <span class="m">00</span> ae <span class="m">25</span> f0 6b aa 24-ed <span class="m">00</span> a9 <span class="m">25</span> <span class="nb">fc</span> 6b aa <span class="m">24</span>  ...%.k.$...%.k.$
</span></span><span class="line"><span class="cl">fffff807<span class="sb">`</span>2a4a00b0  ed <span class="m">00</span> a7 <span class="m">25</span> <span class="m">96</span> 6b aa 24-ed <span class="m">00</span> <span class="m">55</span> <span class="m">24</span> f8 6b aa <span class="m">24</span>  ...%.k.$..U$.k.$
</span></span><span class="line"><span class="cl">fffff807<span class="sb">`</span>2a4a00c0  ed <span class="m">00</span> a8 <span class="m">25</span> f8 6b aa 24-52 <span class="m">69</span> <span class="m">63</span> <span class="m">68</span> f9 6b aa <span class="m">24</span>  ...%.k.<span class="nv">$Rich</span>.k.$
</span></span><span class="line"><span class="cl">fffff807<span class="sb">`</span>2a4a00d0  <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span> <span class="m">00</span>                          ........
</span></span></code></pre></div><h5 id="_image_nt_headers64">_IMAGE_NT_HEADERS64<a href="#_image_nt_headers64" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_NT_HEADERS64 <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0xd8<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Signature        : 0x4550
</span></span><span class="line"><span class="cl">   +0x004 FileHeader       : _IMAGE_FILE_HEADER
</span></span><span class="line"><span class="cl">   +0x018 OptionalHeader   : _IMAGE_OPTIONAL_HEADER64
</span></span></code></pre></div><h5 id="_image_file_header">_IMAGE_FILE_HEADER<a href="#_image_file_header" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_FILE_HEADER <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0xd8 + 0x4<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Machine          : 0x8664
</span></span><span class="line"><span class="cl">   +0x002 NumberOfSections : 0xe
</span></span><span class="line"><span class="cl">   +0x004 TimeDateStamp    : 0x43e8008a
</span></span><span class="line"><span class="cl">   +0x008 PointerToSymbolTable : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x00c NumberOfSymbols  : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x010 SizeOfOptionalHeader : 0xf0
</span></span><span class="line"><span class="cl">   +0x012 Characteristics  : 0x22
</span></span></code></pre></div><h6 id="dll-characteristics">DLL Characteristics<a href="#dll-characteristics" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; .formats 0x22
</span></span><span class="line"><span class="cl">Evaluate expression:
</span></span><span class="line"><span class="cl">  Hex:     00000000<span class="sb">`</span><span class="m">00000022</span>
</span></span><span class="line"><span class="cl">  Decimal: <span class="m">34</span>
</span></span><span class="line"><span class="cl">  Decimal <span class="o">(</span>unsigned<span class="o">)</span> : <span class="m">34</span>
</span></span><span class="line"><span class="cl">  Octal:   <span class="m">0000000000000000000042</span>
</span></span><span class="line"><span class="cl">  Binary:  <span class="m">00000000</span> <span class="m">00000000</span> <span class="m">00000000</span> <span class="m">00000000</span> <span class="m">00000000</span> <span class="m">00000000</span> <span class="m">00000000</span> <span class="m">00100010</span>
</span></span><span class="line"><span class="cl">  Chars:   .......<span class="s2">&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">  Time:    Thu Jan  1 05:30:34 1970
</span></span></span><span class="line"><span class="cl"><span class="s2">  Float:   low 4.76441e-044 high 0
</span></span></span><span class="line"><span class="cl"><span class="s2">  Double:  1.67982e-322
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; ? <span class="o">(</span>0x22 <span class="p">&amp;</span> 0x00f<span class="o">)</span> <span class="o">==</span> 0x40
</span></span><span class="line"><span class="cl">Evaluate expression: <span class="nv">0</span> <span class="o">=</span> 00000000<span class="sb">`</span><span class="m">00000000</span>
</span></span></code></pre></div><ul>
<li>IMAGE_DYNAMIC_BASE : <strong>Disabled</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; ? <span class="o">(</span>0x22 <span class="p">&amp;</span> 0x0f00<span class="o">)</span> <span class="o">==</span> 0x01
</span></span><span class="line"><span class="cl">Evaluate expression: <span class="nv">0</span> <span class="o">=</span> 00000000<span class="sb">`</span><span class="m">00000000</span>
</span></span></code></pre></div><ul>
<li>DATA_EXECUTION_PREVENTION(DEP) : <strong>Disabled</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; ? <span class="o">(</span>0x22 <span class="p">&amp;</span> 0x0f00<span class="o">)</span> <span class="o">==</span> 0x04
</span></span><span class="line"><span class="cl">Evaluate expression: <span class="nv">0</span> <span class="o">=</span> 00000000<span class="sb">`</span><span class="m">00000000</span>
</span></span></code></pre></div><ul>
<li>STRUCTURED_EXCEPTION_HANDLER: <strong>Disabled</strong></li>
</ul>
<h5 id="_image_optional_header64">_IMAGE_OPTIONAL_HEADER64<a href="#_image_optional_header64" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_OPTIONAL_HEADER64 <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0xd8 + 0x18<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Magic            : 0x20b
</span></span><span class="line"><span class="cl">   +0x002 MajorLinkerVersion : 0xe <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">   +0x003 MinorLinkerVersion : 0x14 <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">   +0x004 SizeOfCode       : 0x126c00
</span></span><span class="line"><span class="cl">   +0x008 SizeOfInitializedData : 0x5b400
</span></span><span class="line"><span class="cl">   +0x00c SizeOfUninitializedData : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x010 AddressOfEntryPoint : 0x15f010
</span></span><span class="line"><span class="cl">   +0x014 BaseOfCode       : 0x1000
</span></span><span class="line"><span class="cl">   +0x018 ImageBase        : 0xfffff800<span class="sb">`</span>15e50000
</span></span><span class="line"><span class="cl">   +0x020 SectionAlignment : 0x1000
</span></span><span class="line"><span class="cl">   +0x024 FileAlignment    : 0x200
</span></span><span class="line"><span class="cl">   +0x028 MajorOperatingSystemVersion : 0xa
</span></span><span class="line"><span class="cl">   +0x02a MinorOperatingSystemVersion : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x02c MajorImageVersion : 0xa
</span></span><span class="line"><span class="cl">   +0x02e MinorImageVersion : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x030 MajorSubsystemVersion : 0xa
</span></span><span class="line"><span class="cl">   +0x032 MinorSubsystemVersion : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x034 Win32VersionValue : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x038 SizeOfImage      : 0x188000
</span></span><span class="line"><span class="cl">   +0x03c SizeOfHeaders    : 0x600
</span></span><span class="line"><span class="cl">   +0x040 CheckSum         : 0x188be7
</span></span><span class="line"><span class="cl">   +0x044 Subsystem        : <span class="m">1</span>
</span></span><span class="line"><span class="cl">   +0x046 DllCharacteristics : 0x4160
</span></span><span class="line"><span class="cl">   +0x048 SizeOfStackReserve : 0x40000
</span></span><span class="line"><span class="cl">   +0x050 SizeOfStackCommit : 0x1000
</span></span><span class="line"><span class="cl">   +0x058 SizeOfHeapReserve : 0x100000
</span></span><span class="line"><span class="cl">   +0x060 SizeOfHeapCommit : 0x1000
</span></span><span class="line"><span class="cl">   +0x068 LoaderFlags      : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x06c NumberOfRvaAndSizes : 0x10
</span></span><span class="line"><span class="cl">   +0x070 DataDirectory    : <span class="o">[</span>16<span class="o">]</span> _IMAGE_DATA_DIRECTORY
</span></span></code></pre></div><h5 id="export-directory">Export Directory<a href="#export-directory" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_DATA_DIRECTORY <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0xd8 + 0x18 + 0x70<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 VirtualAddress   : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x004 Size             : <span class="m">0</span>
</span></span></code></pre></div><h5 id="import-directory">Import Directory<a href="#import-directory" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; ?? sizeof<span class="o">(</span>combase!_IMAGE_DATA_DIRECTORY<span class="o">)</span>
</span></span><span class="line"><span class="cl">unsigned int64 <span class="m">8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_DATA_DIRECTORY <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0xd8 + 0x18 + 0x70 + 0x08<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 VirtualAddress   : 0x87d90
</span></span><span class="line"><span class="cl">   +0x004 Size             : 0xa0
</span></span></code></pre></div><h5 id="_image_import_descriptor">_IMAGE_IMPORT_DESCRIPTOR<a href="#_image_import_descriptor" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">_IMAGE_IMPORT_DESCRIPTOR</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">union</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">DWORD</span> <span class="n">Characteristics</span><span class="p">;</span>    <span class="c1">// 0 for terminating null import descriptor
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">DWORD</span> <span class="n">OriginalFirstThunk</span><span class="p">;</span> <span class="c1">// Import Address Name Table (INT)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span> <span class="n">DUMMYUNIONNAME</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">DWORD</span> <span class="n">TimeDateStamp</span><span class="p">;</span>          <span class="c1">// Timestamp when the DLL was bound
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">DWORD</span> <span class="n">ForwarderChain</span><span class="p">;</span>         <span class="c1">// Index of the first forwarder chain, or -1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">DWORD</span> <span class="n">Name</span><span class="p">;</span>                   <span class="c1">// ASCII string containing the DLL name
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">DWORD</span> <span class="n">FirstThunk</span><span class="p">;</span>             <span class="c1">// Import Address Table (IAT)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="n">IMAGE_IMPORT_DESCRIPTOR</span><span class="p">,</span> <span class="o">*</span><span class="n">PIMAGE_IMPORT_DESCRIPTOR</span><span class="p">;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_IMPORT_DESCRIPTOR <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0x87d90<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Characteristics  :  0x880d0  
</span></span><span class="line"><span class="cl">   +0x000 OriginalFirstThunk : 0x880d0 // Points to Import Name Table
</span></span><span class="line"><span class="cl">   +0x004 TimeDateStamp    : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x008 ForwarderChain   : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x00c Name             : 0x8aa38 // DLL Name
</span></span><span class="line"><span class="cl">   +0x010 FirstThunk       : 0x872a0 //Points to Import Address Table
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; da <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0x8aa38<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edaa38  <span class="s2">&#34;ntoskrnl.exe&#34;</span>
</span></span></code></pre></div><h5 id="ntoskrnlexe">NTOSKRNL.EXE<a href="#ntoskrnlexe" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dqs <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0x880d0<span class="o">)</span> L15C
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed80d0  00000000<span class="sb">`</span>000893ec
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed80d8  00000000<span class="sb">`</span>0008940a
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed80e0  00000000<span class="sb">`</span><span class="m">00089426</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed80e8  00000000<span class="sb">`</span><span class="m">00089446</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed80f0  00000000<span class="sb">`</span>0008945a
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed80f8  00000000<span class="sb">`</span><span class="m">00089472</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed8100  00000000<span class="sb">`</span><span class="m">00089480</span>
</span></span><span class="line"><span class="cl">.....
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed8b88  00000000<span class="sb">`</span>0008b438
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed8b90  00000000<span class="sb">`</span>0008b460
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed8b98  00000000<span class="sb">`</span>0008b488
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed8ba0  00000000<span class="sb">`</span>0008b4dc
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed8ba8  00000000<span class="sb">`</span><span class="m">00000000</span>
</span></span></code></pre></div><h6 id="_image_import_by_name">_IMAGE_IMPORT_BY_NAME<a href="#_image_import_by_name" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">// Entry 0x00
</span></span><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_IMPORT_BY_NAME <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>000893ec<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Hint             : 0x815
</span></span><span class="line"><span class="cl">   +0x002 Name             : <span class="o">[</span>1<span class="o">]</span>  <span class="s2">&#34;R&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; da <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>000893ec<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed93ec  <span class="s2">&#34;..RtlEnumerateGenericTableAvl&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Entry 0x1
</span></span><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_IMPORT_BY_NAME <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>0008940a<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Hint             : 0x4c4
</span></span><span class="line"><span class="cl">   +0x002 Name             : <span class="o">[</span>1<span class="o">]</span>  <span class="s2">&#34;K&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; da <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>0008940a<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed940a  <span class="s2">&#34;..KeQueryHighestNodeNumber&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//Entry 0x02 
</span></span><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_IMPORT_BY_NAME <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>00089426<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Hint             : 0x88f
</span></span><span class="line"><span class="cl">   +0x002 Name             : <span class="o">[</span>1<span class="o">]</span>  <span class="s2">&#34;R&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; da <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>00089426<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed9426  <span class="s2">&#34;..RtlInitializeGenericTableAvl&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Entry 0x15a
</span></span><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_IMPORT_BY_NAME <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>0008b4dc<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Hint             : 0xc8
</span></span><span class="line"><span class="cl">   +0x002 Name             : <span class="o">[</span>1<span class="o">]</span>  <span class="s2">&#34;E&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; da <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>0008b4dc<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edb4dc  <span class="s2">&#34;.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; da <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>0008b4dc+0x02<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edb4de  <span class="s2">&#34;ExFreeCacheAwareRundownProtectio&#34;</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edb4fe  <span class="s2">&#34;n&#34;</span>
</span></span></code></pre></div><h6 id="firstthunk-parsing">FirstThunk Parsing<a href="#firstthunk-parsing" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">// ImageBaseAddress + FirstThunk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">: kd&gt; db <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 +0x872a0<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72a0  <span class="m">50</span> f1 <span class="m">96</span> <span class="m">10</span> <span class="m">00</span> f8 ff ff-50 b1 8e <span class="m">10</span> <span class="m">00</span> f8 ff ff  P.......P.......
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72b0  <span class="m">30</span> bd <span class="m">90</span> <span class="m">10</span> <span class="m">00</span> f8 ff ff-80 <span class="m">40</span> <span class="m">87</span> <span class="m">10</span> <span class="m">00</span> f8 ff ff  0........@......
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72c0  <span class="m">70</span> <span class="m">74</span> <span class="m">86</span> <span class="m">10</span> <span class="m">00</span> f8 ff ff-90 <span class="m">51</span> <span class="m">86</span> <span class="m">10</span> <span class="m">00</span> f8 ff ff  pt.......Q......
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72d0  <span class="m">30</span> <span class="m">74</span> 9e <span class="m">10</span> <span class="m">00</span> f8 ff ff-30 1a 8f <span class="m">10</span> <span class="m">00</span> f8 ff ff  0t......0.......
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72e0  <span class="m">60</span> 6c bf <span class="m">10</span> <span class="m">00</span> f8 ff ff-40 ca c8 <span class="m">10</span> <span class="m">00</span> f8 ff ff  <span class="sb">`</span>l......@.......
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72f0  <span class="m">30</span> a4 f9 <span class="m">10</span> <span class="m">00</span> f8 ff ff-f0 a3 <span class="m">93</span> <span class="m">10</span> <span class="m">00</span> f8 ff ff  0...............
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7300  <span class="m">10</span> <span class="m">52</span> <span class="m">94</span> <span class="m">10</span> <span class="m">00</span> f8 ff ff-60 1e 8d <span class="m">10</span> <span class="m">00</span> f8 ff ff  .R......<span class="sb">`</span>.......
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7310  <span class="m">60</span> 5e <span class="m">84</span> <span class="m">10</span> <span class="m">00</span> f8 ff ff-90 <span class="m">45</span> 9e <span class="m">10</span> <span class="m">00</span> f8 ff ff  <span class="sb">`</span>^.......E......
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; dq <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 +0x872a0<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72a0  fffff800<span class="sb">`</span>1096f150 fffff800<span class="sb">`</span>108eb150
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72b0  fffff800<span class="sb">`</span>1090bd30 fffff800<span class="sb">`</span><span class="m">10874080</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72c0  fffff800<span class="sb">`</span><span class="m">10867470</span> fffff800<span class="sb">`</span><span class="m">10865190</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72d0  fffff800<span class="sb">`</span>109e7430 fffff800<span class="sb">`</span>108f1a30
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72e0  fffff800<span class="sb">`</span>10bf6c60 fffff800<span class="sb">`</span>10c8ca40
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72f0  fffff800<span class="sb">`</span>10f9a430 fffff800<span class="sb">`</span>1093a3f0
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7300  fffff800<span class="sb">`</span><span class="m">10945210</span> fffff800<span class="sb">`</span>108d1e60
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7310  fffff800<span class="sb">`</span>10845e60 fffff800<span class="sb">`</span>109e4590
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">nt!RtlEnumerateGenericTableAvl:
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>1096f150 4883ec28        sub     rsp,28h
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>1096f154 84d2            <span class="nb">test</span>    dl,dl
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>1096f156 <span class="m">7405</span>            je      nt!RtlEnumerateGenericTableAvl+0xd <span class="o">(</span>fffff800<span class="sb">`</span>1096f15d<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>1096f158 <span class="m">4883613800</span>      and     qword ptr <span class="o">[</span>rcx+38h<span class="o">]</span>,0
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>1096f15d 488d5138        lea     rdx,<span class="o">[</span>rcx+38h<span class="o">]</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>1096f161 e8cac1f9ff      call    nt!RtlEnumerateGenericTableWithoutSplayingAvl <span class="o">(</span>fffff800<span class="sb">`</span>1090b330<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>1096f166 4883c428        add     rsp,28h
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>1096f16a c3              ret
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">.....
</span></span><span class="line"><span class="cl">.....
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; dq <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 +0x872a0 + 0x08 * <span class="o">(</span>0x15a<span class="o">))</span> L1
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7d70  fffff800<span class="sb">`</span>108162e0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; u fffff800<span class="sb">`</span>108162e0
</span></span><span class="line"><span class="cl">nt!ExFreeCacheAwareRundownProtection:
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>108162e0 <span class="m">4053</span>            push    rbx
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>108162e2 4883ec20        sub     rsp,20h
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>108162e6 488bd9          mov     rbx,rcx
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>108162e9 488b4908        mov     rcx,qword ptr <span class="o">[</span>rcx+8<span class="o">]</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>108162ed e8fed20400      call    nt!ExFreeHeapPool <span class="o">(</span>fffff800<span class="sb">`</span>108635f0<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>108162f2 488bcb          mov     rcx,rbx
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>108162f5 e8f6d20400      call    nt!ExFreeHeapPool <span class="o">(</span>fffff800<span class="sb">`</span>108635f0<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>108162fa 4883c420        add     rsp,20h
</span></span></code></pre></div><p><code>dqs</code> : display a sequence of quadwords along with symbols.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">// ImageBaseAddress + FirstThunk
</span></span><span class="line"><span class="cl">0: kd&gt; dqs <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0x872a0<span class="o">)</span> L20
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72a0  fffff800<span class="sb">`</span>1096f150 nt!RtlEnumerateGenericTableAvl
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72a8  fffff800<span class="sb">`</span>108eb150 nt!KeQueryHighestNodeNumber
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72b0  fffff800<span class="sb">`</span>1090bd30 nt!RtlInitializeGenericTableAvl
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72b8  fffff800<span class="sb">`</span><span class="m">10874080</span> nt!KeInitializeEvent
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72c0  fffff800<span class="sb">`</span><span class="m">10867470</span> nt!KeWaitForSingleObject
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72c8  fffff800<span class="sb">`</span><span class="m">10865190</span> nt!KeSetEvent
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72d0  fffff800<span class="sb">`</span>109e7430 nt!wcschr
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72d8  fffff800<span class="sb">`</span>108f1a30 nt!MmIsThisAnNtAsSystem
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72e0  fffff800<span class="sb">`</span>10bf6c60 nt!RtlUpcaseUnicodeString
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72e8  fffff800<span class="sb">`</span>10c8ca40 nt!RtlUpcaseUnicodeChar
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72f0  fffff800<span class="sb">`</span>10f9a430 nt!NlsLeadByteInfo
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed72f8  fffff800<span class="sb">`</span>1093a3f0 nt!MmSizeOfMdl
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7300  fffff800<span class="sb">`</span><span class="m">10945210</span> nt!IoGetRequestorProcess
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7308  fffff800<span class="sb">`</span>108d1e60 nt!KeStackAttachProcess
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7310  fffff800<span class="sb">`</span>10845e60 nt!KeUnstackDetachProcess
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7318  fffff800<span class="sb">`</span>109e4590 nt!vsnwprintf
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7320  fffff800<span class="sb">`</span>10d321b0 nt!RtlUnicodeToUTF8N
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7328  fffff800<span class="sb">`</span>109e4a60 nt!strncmp
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7330  fffff800<span class="sb">`</span><span class="m">10880060</span> nt!MmMapLockedPagesSpecifyCache
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7338  fffff800<span class="sb">`</span>1085bfc0 nt!IoAllocateMdl
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7340  fffff800<span class="sb">`</span><span class="m">10932820</span> nt!MmBuildMdlForNonPagedPool
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7348  fffff800<span class="sb">`</span>10ba29b0 nt!RtlQueryFeatureConfigurationChangeStamp
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7350  fffff800<span class="sb">`</span>1099fae0 nt!RtlQueryFeatureConfiguration
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7358  fffff800<span class="sb">`</span>10ba29c0 nt!RtlRegisterFeatureConfigurationChangeNotification
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7360  fffff800<span class="sb">`</span>10f2fd90 nt!RtlUnregisterFeatureConfigurationChangeNotification
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7368  fffff800<span class="sb">`</span>10a10a20 nt!ZwQueryWnfStateData
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7370  fffff800<span class="sb">`</span>10fcb010 nt!ExAllocatePoolWithTag
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7378  fffff800<span class="sb">`</span>10ba2990 nt!RtlNotifyFeatureUsage
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7380  fffff800<span class="sb">`</span>1093ca40 nt!KeQueryMaximumProcessorCountEx
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7388  fffff800<span class="sb">`</span>10d25dd0 nt!RtlGetVersion
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7390  fffff800<span class="sb">`</span>10a0dfe0 nt!ZwOpenKey
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7398  fffff800<span class="sb">`</span>10d31230 nt!RtlIsStateSeparationEnabled
</span></span></code></pre></div><p>Parsing <code>HTTP.sys</code> using <a href="https://github.com/5h4rrk/PEInsight">PEInsight</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">        ntoskrnl.exe
</span></span><span class="line"><span class="cl">        ----------------
</span></span><span class="line"><span class="cl">          Hint         Name                                                             <span class="p">|</span>
</span></span><span class="line"><span class="cl">        +-------------------------------------------------------------------------------+
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">2069</span>       <span class="p">|</span> RtlEnumerateGenericTableAvl                                      <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1220</span>       <span class="p">|</span> KeQueryHighestNodeNumber                                         <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">2191</span>       <span class="p">|</span> RtlInitializeGenericTableAvl                                     <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1162</span>       <span class="p">|</span> KeInitializeEvent                                                <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1335</span>       <span class="p">|</span> KeWaitForSingleObject                                            <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1292</span>       <span class="p">|</span> KeSetEvent                                                       <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">3047</span>       <span class="p">|</span> wcschr                                                           <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1431</span>       <span class="p">|</span> MmIsThisAnNtAsSystem                                             <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">2421</span>       <span class="p">|</span> RtlUpcaseUnicodeString                                           <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">2420</span>       <span class="p">|</span> RtlUpcaseUnicodeChar                                             <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1496</span>       <span class="p">|</span> NlsLeadByteInfo                                                  <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1479</span>       <span class="p">|</span> MmSizeOfMdl                                                      <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">849</span>        <span class="p">|</span> IoGetRequestorProcess                                            <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1315</span>       <span class="p">|</span> KeStackAttachProcess                                             <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1330</span>       <span class="p">|</span> KeUnstackDetachProcess                                           <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">2967</span>       <span class="p">|</span> _vsnwprintf                                                      <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">2414</span>       <span class="p">|</span> RtlUnicodeToUTF8N                                                <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">3025</span>       <span class="p">|</span> strncmp                                                          <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1441</span>       <span class="p">|</span> MmMapLockedPagesSpecifyCache                                     <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">710</span>        <span class="p">|</span> IoAllocateMdl                                                    <span class="p">|</span>
</span></span><span class="line"><span class="cl">        ..........
</span></span><span class="line"><span class="cl">        ..........
</span></span><span class="line"><span class="cl">        ..........
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">1258</span>       <span class="p">|</span> KeReleaseMutex                                                   <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">145</span>        <span class="p">|</span> ExAcquireRundownProtectionCacheAware                             <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">157</span>        <span class="p">|</span> ExAllocateCacheAwareRundownProtection                            <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">285</span>        <span class="p">|</span> ExReleaseRundownProtectionCacheAware                             <span class="p">|</span>
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">200</span>        <span class="p">|</span> ExFreeCacheAwareRundownProtection                                <span class="p">|</span>
</span></span><span class="line"><span class="cl">        +-------------------------------------------------------------------------------+
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; ?? sizeof<span class="o">(</span>_IMAGE_IMPORT_DESCRIPTOR<span class="o">)</span>
</span></span><span class="line"><span class="cl">unsigned int64 0x14
</span></span></code></pre></div><h6 id="_image_import_descriptor-1">_IMAGE_IMPORT_DESCRIPTOR<a href="#_image_import_descriptor-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_IMPORT_DESCRIPTOR  <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0x87d90 + 0x14<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Characteristics  : 0x87e30
</span></span><span class="line"><span class="cl">   +0x000 OriginalFirstThunk : 0x87e30 // Import Name Table
</span></span><span class="line"><span class="cl">   +0x004 TimeDateStamp    : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x008 ForwarderChain   : <span class="m">0</span>
</span></span><span class="line"><span class="cl">   +0x00c Name             : 0x8aa62 // DLL Name
</span></span><span class="line"><span class="cl">   +0x010 FirstThunk       : 0x87000 // Import Address Table
</span></span></code></pre></div><h5 id="haldll">HAL.dll<a href="#haldll" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; da  <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0x8aa62<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edaa62  <span class="s2">&#34;HAL.dll&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dqs  <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0x87e30<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7e30  00000000<span class="sb">`</span>0008aa46 
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7e38  00000000<span class="sb">`</span><span class="m">00000000</span> // Ends Entry <span class="k">for</span> HAL.dll 
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7e40  00000000<span class="sb">`</span>0008b1d6
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7e48  00000000<span class="sb">`</span>0008b1b2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0: kd&gt; db  <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>0008aa46<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edaa46  <span class="m">54</span> <span class="m">00</span> 4b <span class="m">65</span> <span class="m">51</span> <span class="m">75</span> <span class="m">65</span> 72-79 <span class="m">50</span> <span class="m">65</span> <span class="m">72</span> <span class="m">66</span> 6f <span class="m">72</span> 6d  T.KeQueryPerform
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edaa56  <span class="m">61</span> 6e <span class="m">63</span> <span class="m">65</span> <span class="m">43</span> 6f <span class="m">75</span> 6e-74 <span class="m">65</span> <span class="m">72</span> <span class="m">00</span> <span class="m">48</span> <span class="m">41</span> 4c 2e  anceCounter.HAL.
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edaa66  <span class="m">64</span> 6c 6c <span class="m">00</span> 2c <span class="m">00</span> <span class="m">46</span> 72-65 <span class="m">65</span> <span class="m">43</span> 6f 6e <span class="m">74</span> <span class="m">65</span> <span class="m">78</span>  dll.,.FreeContex
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edaa76  <span class="m">74</span> <span class="m">42</span> <span class="m">75</span> <span class="m">66</span> <span class="m">66</span> <span class="m">65</span> <span class="m">72</span> 00-4c <span class="m">00</span> <span class="m">53</span> <span class="m">73</span> 6c <span class="m">47</span> <span class="m">65</span> <span class="m">74</span>  tBuffer.L.SslGet
</span></span></code></pre></div><h6 id="_image_import_by_name-1">_IMAGE_IMPORT_BY_NAME<a href="#_image_import_by_name-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dt combase!_IMAGE_IMPORT_BY_NAME <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>0008aa46<span class="o">)</span>
</span></span><span class="line"><span class="cl">   +0x000 Hint             : 0x54
</span></span><span class="line"><span class="cl">   +0x002 Name             : <span class="o">[</span>1<span class="o">]</span>  <span class="s2">&#34;K&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// HINT
</span></span><span class="line"><span class="cl">0: kd&gt; da  <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>0008aa46<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edaa46  <span class="s2">&#34;T&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// NAME 
</span></span><span class="line"><span class="cl">0: kd&gt; da  <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 00000000<span class="sb">`</span>0008aa46 + 0x2<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15edaa48  <span class="s2">&#34;KeQueryPerformanceCounter&#34;</span>
</span></span></code></pre></div><h6 id="firstthunk-parsing-1">FirstThunk Parsing<a href="#firstthunk-parsing-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">// ImageBaseAddress + FirstThunk
</span></span><span class="line"><span class="cl">0: kd&gt; dqs  <span class="o">(</span>fffff800<span class="sb">`</span>15e50000 + 0x87000<span class="o">)</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7000  fffff800<span class="sb">`</span>1083c380 nt!KeQueryPerformanceCounter
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7008  00000000<span class="sb">`</span><span class="m">00000000</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7010  fffff800<span class="sb">`</span>128e1450 ndis!NdisGetJobObjectCompartmentId
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7018  fffff800<span class="sb">`</span>12837a20 ndis!NdisGetThreadObjectCompartmentId
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7020  00000000<span class="sb">`</span><span class="m">00000000</span>
</span></span></code></pre></div><p>Parsing <code>HTTP.sys</code> using <a href="https://github.com/5h4rrk/PEInsight">PEInsight</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">       HAL.dll
</span></span><span class="line"><span class="cl">        ----------------
</span></span><span class="line"><span class="cl">          Hint         Name                                                             <span class="p">|</span>
</span></span><span class="line"><span class="cl">        +-------------------------------------------------------------------------------+
</span></span><span class="line"><span class="cl">        <span class="p">|</span> <span class="m">84</span>         <span class="p">|</span> KeQueryPerformanceCounter                                        <span class="p">|</span>
</span></span><span class="line"><span class="cl">        +-------------------------------------------------------------------------------+
</span></span></code></pre></div><h4 id="parsing-it-with-extension-command">Parsing it with Extension command<a href="#parsing-it-with-extension-command" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; !dh -f HTTP
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">File Type: EXECUTABLE IMAGE
</span></span><span class="line"><span class="cl">FILE HEADER VALUES
</span></span><span class="line"><span class="cl">    <span class="m">8664</span> machine <span class="o">(</span>X64<span class="o">)</span>
</span></span><span class="line"><span class="cl">       E number of sections
</span></span><span class="line"><span class="cl">43E8008A <span class="nb">time</span> date stamp Tue Feb  <span class="m">7</span> 07:36:02 <span class="m">2006</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="m">0</span> file pointer to symbol table
</span></span><span class="line"><span class="cl">       <span class="m">0</span> number of symbols
</span></span><span class="line"><span class="cl">      F0 size of optional header
</span></span><span class="line"><span class="cl">      <span class="m">22</span> characteristics
</span></span><span class="line"><span class="cl">            Executable
</span></span><span class="line"><span class="cl">            App can handle &gt;2gb addresses
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">OPTIONAL HEADER VALUES
</span></span><span class="line"><span class="cl">     20B magic <span class="c1">#</span>
</span></span><span class="line"><span class="cl">   14.20 linker version
</span></span><span class="line"><span class="cl">  126C00 size of code
</span></span><span class="line"><span class="cl">   5B400 size of initialized data
</span></span><span class="line"><span class="cl">       <span class="m">0</span> size of uninitialized data
</span></span><span class="line"><span class="cl">  15F010 address of entry point
</span></span><span class="line"><span class="cl">    <span class="m">1000</span> base of code
</span></span><span class="line"><span class="cl">         ----- new -----
</span></span><span class="line"><span class="cl">fffff80015e50000 image base
</span></span><span class="line"><span class="cl">    <span class="m">1000</span> section alignment
</span></span><span class="line"><span class="cl">     <span class="m">200</span> file alignment
</span></span><span class="line"><span class="cl">       <span class="m">1</span> subsystem <span class="o">(</span>Native<span class="o">)</span>
</span></span><span class="line"><span class="cl">   10.00 operating system version
</span></span><span class="line"><span class="cl">   10.00 image version
</span></span><span class="line"><span class="cl">   10.00 subsystem version
</span></span><span class="line"><span class="cl">  <span class="m">188000</span> size of image
</span></span><span class="line"><span class="cl">     <span class="m">600</span> size of headers
</span></span><span class="line"><span class="cl">  188BE7 checksum
</span></span><span class="line"><span class="cl"><span class="m">0000000000040000</span> size of stack reserve
</span></span><span class="line"><span class="cl"><span class="m">0000000000001000</span> size of stack commit
</span></span><span class="line"><span class="cl"><span class="m">0000000000100000</span> size of heap reserve
</span></span><span class="line"><span class="cl"><span class="m">0000000000001000</span> size of heap commit
</span></span><span class="line"><span class="cl">    <span class="m">4160</span>  DLL characteristics
</span></span><span class="line"><span class="cl">            High entropy VA supported
</span></span><span class="line"><span class="cl">            Dynamic base
</span></span><span class="line"><span class="cl">            NX compatible
</span></span><span class="line"><span class="cl">            Guard
</span></span><span class="line"><span class="cl">       <span class="m">0</span> <span class="o">[</span>       0<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Export Directory
</span></span><span class="line"><span class="cl">   87D90 <span class="o">[</span>      A0<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Import Directory
</span></span><span class="line"><span class="cl">  <span class="m">162000</span> <span class="o">[</span>   1D810<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Resource Directory
</span></span><span class="line"><span class="cl">   7A000 <span class="o">[</span>    C834<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Exception Directory
</span></span><span class="line"><span class="cl">  <span class="m">180800</span> <span class="o">[</span>    25F0<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Security Directory
</span></span><span class="line"><span class="cl">  <span class="m">180000</span> <span class="o">[</span>     97C<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Base Relocation Directory
</span></span><span class="line"><span class="cl">   <span class="m">61590</span> <span class="o">[</span>      54<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Debug Directory
</span></span><span class="line"><span class="cl">       <span class="m">0</span> <span class="o">[</span>       0<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Description Directory
</span></span><span class="line"><span class="cl">       <span class="m">0</span> <span class="o">[</span>       0<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Special Directory
</span></span><span class="line"><span class="cl">       <span class="m">0</span> <span class="o">[</span>       0<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Thread Storage Directory
</span></span><span class="line"><span class="cl">   5C8A0 <span class="o">[</span>     118<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Load Configuration Directory
</span></span><span class="line"><span class="cl">       <span class="m">0</span> <span class="o">[</span>       0<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Bound Import Directory
</span></span><span class="line"><span class="cl">   <span class="m">87000</span> <span class="o">[</span>     D80<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Import Address Table Directory
</span></span><span class="line"><span class="cl">       <span class="m">0</span> <span class="o">[</span>       0<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Delay Import Directory
</span></span><span class="line"><span class="cl">       <span class="m">0</span> <span class="o">[</span>       0<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of COR20 Header Directory
</span></span><span class="line"><span class="cl">       <span class="m">0</span> <span class="o">[</span>       0<span class="o">]</span> address <span class="o">[</span>size<span class="o">]</span> of Reserved Directory
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0: kd&gt; dps HTTP+87000
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7000  fffff800<span class="sb">`</span>1083c380 nt!KeQueryPerformanceCounter
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7008  00000000<span class="sb">`</span><span class="m">00000000</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7010  fffff800<span class="sb">`</span>128e1450 ndis!NdisGetJobObjectCompartmentId
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7018  fffff800<span class="sb">`</span>12837a20 ndis!NdisGetThreadObjectCompartmentId
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7020  00000000<span class="sb">`</span><span class="m">00000000</span>
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7028  fffff800<span class="sb">`</span>129d8610 NETIO!NsiRegisterChangeNotification
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7030  fffff800<span class="sb">`</span>129f00b0 NETIO!CancelMibChangeNotify2
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7038  fffff800<span class="sb">`</span>129fab00 NETIO!NsiDeregisterChangeNotification
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7040  fffff800<span class="sb">`</span>129d8420 NETIO!NotifyUnicastIpAddressChange
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7048  fffff800<span class="sb">`</span>129f9530 NETIO!NmrClientDetachProviderComplete
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7050  fffff800<span class="sb">`</span>129d16e0 NETIO!NmrClientAttachProvider
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7058  fffff800<span class="sb">`</span>129f95f0 NETIO!NmrWaitForClientDeregisterComplete
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7060  fffff800<span class="sb">`</span>129f9590 NETIO!NmrDeregisterClient
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7068  fffff800<span class="sb">`</span>129d0bf0 NETIO!NmrRegisterClient
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7070  fffff800<span class="sb">`</span>129d9890 NETIO!KfdFreeEnumHandle
</span></span><span class="line"><span class="cl">fffff800<span class="sb">`</span>15ed7078  fffff800<span class="sb">`</span>129cc500 NETIO!KfdDerefFilterContext
</span></span><span class="line"><span class="cl">.....
</span></span></code></pre></div><p>To dump the everything from executable</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">!dh -a fffff800<span class="sb">`</span>15e50000 
</span></span></code></pre></div>
      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h"></span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="http://localhost:1313/posts/windows-shellcode/">
                <span class="button__icon">â†</span>
                <span class="button__text">Windows Shellcode Development &amp; Debugging with WinDbg: A Hands-On Guide (Part 1)</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="http://localhost:1313/posts/pe-parse-windbg/pe-parse-windbg/">
                <span class="button__text">Decoding PE Files A Step-by-Step Guide with WinDbg - Part 1</span>
                <span class="button__icon">â†’</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Â© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/mirus-ua/hugo-theme-re-terminal" target="_blank">Theme</a> made by <a href="https://github.com/mirus-ua" target="_blank">Mirus</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>








  
</div>

</body>
</html>
